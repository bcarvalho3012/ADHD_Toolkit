<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Name Your Beast ‚Äî The ADHD Trait-to-Tool Map</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&family=DM+Sans:wght@400;500;700&display=swap');

:root {
  --red: #E8443A;
  --yellow: #F5A623;
  --blue: #4A90D9;
  --green: #5CB85C;
  --purple: #8E6FBF;
  --dark: #1E1E2E;
  --darker: #14141F;
  --card-bg: #252540;
  --card-hover: #2E2E50;
  --text-main: #E8E8F0;
  --text-muted: #9595B0;
  --accent: #FF6B6B;
  --glow: rgba(255, 107, 107, 0.15);
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: 'DM Sans', sans-serif;
  background: var(--darker);
  color: var(--text-main);
  min-height: 100vh;
  overflow-x: hidden;
}

/* Texture overlay */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background: url("data:image/svg+xml,%3Csvg width='60' height='60' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");
  pointer-events: none;
  z-index: 0;
}

/* ============ HERO ============ */
.hero {
  position: relative;
  padding: 4rem 2rem 3rem;
  text-align: center;
  background: linear-gradient(135deg, var(--darker) 0%, #1a1a35 50%, var(--darker) 100%);
  border-bottom: 1px solid rgba(255,255,255,0.04);
}

.hero::after {
  content: '';
  position: absolute;
  bottom: -60px;
  left: 50%;
  transform: translateX(-50%);
  width: 300px;
  height: 120px;
  background: radial-gradient(ellipse, var(--glow), transparent 70%);
  pointer-events: none;
}

.hero h1 {
  font-family: 'Fredoka', sans-serif;
  font-size: clamp(2.2rem, 5vw, 3.6rem);
  font-weight: 700;
  line-height: 1.15;
  letter-spacing: -0.02em;
  background: linear-gradient(135deg, #FF6B6B, #FFD93D, #6BCB77, #4D96FF);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  margin-bottom: 0.75rem;
}

.hero .subtitle {
  font-size: 1.15rem;
  color: var(--text-muted);
  max-width: 600px;
  margin: 0 auto 1.5rem;
  line-height: 1.55;
}

.hero .source-note {
  font-size: 0.8rem;
  color: #666;
  font-style: italic;
}

/* ============ NAV TABS ============ */
.nav-bar {
  position: sticky;
  top: 0;
  z-index: 100;
  background: rgba(20, 20, 31, 0.92);
  backdrop-filter: blur(16px);
  border-bottom: 1px solid rgba(255,255,255,0.06);
  padding: 0.6rem 1rem;
  display: flex;
  gap: 0.5rem;
  overflow-x: auto;
  justify-content: center;
  flex-wrap: wrap;
}

.nav-btn {
  font-family: 'DM Sans', sans-serif;
  font-size: 0.85rem;
  font-weight: 600;
  padding: 0.5rem 1.1rem;
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 999px;
  background: transparent;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;
}

.nav-btn:hover { background: rgba(255,255,255,0.06); color: var(--text-main); }
.nav-btn.active { background: var(--accent); color: #fff; border-color: var(--accent); }

.nav-btn.nav-myday {
  border-color: rgba(107,203,119,0.4);
  color: #6BCB77;
}
.nav-btn.nav-myday.active { background: #6BCB77; color: #000; border-color: #6BCB77; }
.nav-btn.nav-myday:hover:not(.active) { background: rgba(107,203,119,0.1); }

.nav-btn.nav-fav {
  border-color: rgba(255,217,61,0.4);
  color: #FFD93D;
}
.nav-btn.nav-fav.active { background: #FFD93D; color: #000; border-color: #FFD93D; }
.nav-btn.nav-fav:hover:not(.active) { background: rgba(255,217,61,0.1); }

/* ============ CONTAINER ============ */
.container {
  max-width: 1100px;
  margin: 0 auto;
  padding: 2rem 1.5rem 4rem;
  position: relative;
  z-index: 1;
}

/* ============ SECTION HEADERS ============ */
.section-header {
  margin: 3rem 0 1.5rem;
  padding-bottom: 0.75rem;
  border-bottom: 2px solid rgba(255,255,255,0.06);
}

.section-header:first-child { margin-top: 0; }

.section-header h2 {
  font-family: 'Fredoka', sans-serif;
  font-size: 1.7rem;
  font-weight: 600;
}

.section-header p {
  color: var(--text-muted);
  margin-top: 0.3rem;
  font-size: 0.95rem;
}

/* ============ TRAIT CARDS ============ */
.trait-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 1.25rem;
}

.trait-card {
  background: var(--card-bg);
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,0.05);
  overflow: hidden;
  transition: transform 0.2s, box-shadow 0.2s;
  animation: cardFadeIn 0.3s ease both;
}

@keyframes cardFadeIn {
  from { opacity: 0; transform: translateY(12px); }
  to { opacity: 1; transform: translateY(0); }
}

.trait-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(0,0,0,0.3);
}

.trait-header {
  padding: 1.25rem 1.5rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  user-select: none;
}

.trait-icon {
  width: 48px;
  height: 48px;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
  flex-shrink: 0;
}

.trait-title-group { flex: 1; }

.trait-title-group h3 {
  font-family: 'Fredoka', sans-serif;
  font-size: 1.2rem;
  font-weight: 600;
  margin-bottom: 0.15rem;
}

.trait-title-group .aka {
  font-size: 0.82rem;
  color: var(--text-muted);
  font-style: italic;
}

.expand-arrow {
  font-size: 1.2rem;
  color: var(--text-muted);
  transition: transform 0.3s;
}

.trait-card.open .expand-arrow { transform: rotate(180deg); }

.trait-body {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.4s ease;
}

.trait-card.open .trait-body {
  max-height: 5000px;
}

.trait-content {
  padding: 0 1.5rem 1.5rem;
}

/* Sub-sections inside trait */
.trait-section {
  margin-bottom: 1.25rem;
}

.trait-section-label {
  font-family: 'Fredoka', sans-serif;
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  margin-bottom: 0.5rem;
  padding: 0.25rem 0.65rem;
  border-radius: 6px;
  display: inline-block;
}

.label-what { background: rgba(78,205,196,0.15); color: #4ECDC4; }
.label-feel { background: rgba(255,107,107,0.15); color: #FF6B6B; }
.label-tool { background: rgba(107,203,119,0.15); color: #6BCB77; }
.label-how { background: rgba(77,150,255,0.15); color: #4D96FF; }

.trait-section p, .trait-section li {
  color: var(--text-muted);
  font-size: 0.92rem;
  line-height: 1.65;
}

.trait-section ul {
  list-style: none;
  padding: 0;
}

.trait-section li {
  padding: 0.35rem 0 0.35rem 1.4rem;
  position: relative;
}

.trait-section li::before {
  content: '‚Üí';
  position: absolute;
  left: 0;
  color: var(--accent);
}

/* ============ TOOL CARDS ============ */
.tool-card {
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 12px;
  padding: 1rem 1.25rem;
  margin-bottom: 0.75rem;
  position: relative;
}

.tool-card h4 {
  font-family: 'Fredoka', sans-serif;
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 0.4rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.tool-card .steps {
  counter-reset: step;
  list-style: none;
  padding: 0;
}

.tool-card .steps li {
  counter-increment: step;
  padding: 0.3rem 0 0.3rem 2rem;
  position: relative;
  color: var(--text-muted);
  font-size: 0.88rem;
  line-height: 1.55;
}

.tool-card .steps li::before {
  content: counter(step);
  position: absolute;
  left: 0;
  top: 0.35rem;
  width: 1.4rem;
  height: 1.4rem;
  border-radius: 50%;
  background: rgba(255,107,107,0.15);
  color: var(--accent);
  font-size: 0.72rem;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ============ FAVORITE BUTTON ============ */
.fav-btn {
  position: absolute;
  top: 0.75rem;
  right: 0.75rem;
  background: none;
  border: none;
  font-size: 1.2rem;
  cursor: pointer;
  opacity: 0.3;
  transition: all 0.2s;
  filter: grayscale(1);
  padding: 0.25rem;
  z-index: 2;
}
.fav-btn:hover { opacity: 0.7; transform: scale(1.15); }
.fav-btn.favorited { opacity: 1; filter: grayscale(0); animation: favPop 0.3s ease; }

@keyframes favPop {
  0% { transform: scale(1); }
  50% { transform: scale(1.4); }
  100% { transform: scale(1); }
}

/* ============ INLINE TIMER ============ */
.inline-timer {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  background: rgba(255,107,107,0.1);
  border: 1px solid rgba(255,107,107,0.2);
  border-radius: 999px;
  padding: 0.3rem 0.75rem;
  margin-top: 0.75rem;
  font-size: 0.82rem;
  color: var(--accent);
  cursor: pointer;
  transition: all 0.2s;
  font-family: 'DM Sans', sans-serif;
  font-weight: 600;
}
.inline-timer:hover { background: rgba(255,107,107,0.2); }
.inline-timer.running { background: rgba(107,203,119,0.15); border-color: rgba(107,203,119,0.3); color: #6BCB77; }
.inline-timer .timer-display { font-variant-numeric: tabular-nums; min-width: 3.5rem; }

/* ============ GRID SECTION ============ */
.solve-it-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;
  margin: 1.5rem 0;
}

.grid-quad {
  border-radius: 14px;
  padding: 1.5rem;
  position: relative;
  overflow: hidden;
}

.grid-quad::before {
  content: '';
  position: absolute;
  inset: 0;
  background: inherit;
  opacity: 0.12;
  border-radius: inherit;
}

.grid-quad h3 {
  font-family: 'Fredoka', sans-serif;
  font-size: 1.15rem;
  position: relative;
  z-index: 1;
  margin-bottom: 0.5rem;
}

.grid-quad p, .grid-quad li {
  position: relative;
  z-index: 1;
  font-size: 0.88rem;
  line-height: 1.55;
  color: var(--text-muted);
}

.grid-quad ul { list-style: none; padding: 0; }
.grid-quad li { padding: 0.2rem 0 0.2rem 1.2rem; position: relative; }
.grid-quad li::before { content: '‚Ä¢'; position: absolute; left: 0; }

.q-red { background: rgba(232,68,58,0.12); border: 1px solid rgba(232,68,58,0.2); }
.q-red h3 { color: var(--red); }
.q-red li::before { color: var(--red); }
.q-yellow { background: rgba(245,166,35,0.12); border: 1px solid rgba(245,166,35,0.2); }
.q-yellow h3 { color: var(--yellow); }
.q-yellow li::before { color: var(--yellow); }
.q-blue { background: rgba(74,144,217,0.12); border: 1px solid rgba(74,144,217,0.2); }
.q-blue h3 { color: var(--blue); }
.q-blue li::before { color: var(--blue); }
.q-green { background: rgba(92,184,92,0.12); border: 1px solid rgba(92,184,92,0.2); }
.q-green h3 { color: var(--green); }
.q-green li::before { color: var(--green); }

/* ============ LADDER ============ */
.ladder {
  display: flex;
  flex-direction: column;
  gap: 0;
  margin: 1.5rem 0;
}

.ladder-rung {
  padding: 1.25rem 1.5rem;
  border-left: 4px solid;
  background: var(--card-bg);
  cursor: pointer;
  transition: background 0.2s;
}

.ladder-rung:first-child { border-radius: 14px 14px 0 0; }
.ladder-rung:last-child { border-radius: 0 0 14px 14px; }
.ladder-rung:hover { background: var(--card-hover); }

.ladder-rung h4 {
  font-family: 'Fredoka', sans-serif;
  font-size: 1rem;
  display: flex;
  align-items: center;
  gap: 0.6rem;
}

.ladder-rung .detail {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s;
}

.ladder-rung.open .detail { max-height: 600px; }

.ladder-rung .detail p {
  margin-top: 0.5rem;
  font-size: 0.88rem;
  color: var(--text-muted);
  line-height: 1.6;
}

.l1 { border-color: #6BCB77; } .l1 h4 { color: #6BCB77; }
.l2 { border-color: #4ECDC4; } .l2 h4 { color: #4ECDC4; }
.l3 { border-color: #F5A623; } .l3 h4 { color: #F5A623; }
.l4 { border-color: #E8443A; } .l4 h4 { color: #E8443A; }
.l5 { border-color: #8E3B5E; } .l5 h4 { color: #C06080; }

/* ============ SEARCH ============ */
.search-box {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 1.5rem;
}

.search-box input {
  flex: 1;
  padding: 0.75rem 1.25rem;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.1);
  background: var(--card-bg);
  color: var(--text-main);
  font-family: 'DM Sans', sans-serif;
  font-size: 0.95rem;
  outline: none;
}

.search-box input:focus { border-color: var(--accent); }
.search-box input::placeholder { color: var(--text-muted); }

/* ============ CATEGORY FILTER ============ */
.filter-bar {
  display: flex;
  gap: 0.4rem;
  flex-wrap: wrap;
  margin-bottom: 1.5rem;
}

.filter-chip {
  font-family: 'DM Sans', sans-serif;
  font-size: 0.78rem;
  font-weight: 600;
  padding: 0.35rem 0.8rem;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.08);
  background: transparent;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.2s;
}

.filter-chip:hover { background: rgba(255,255,255,0.06); }
.filter-chip.active { background: var(--purple); color: #fff; border-color: var(--purple); }

/* ============ FOOTER ============ */
.footer {
  text-align: center;
  padding: 3rem 1rem;
  color: #555;
  font-size: 0.8rem;
  border-top: 1px solid rgba(255,255,255,0.04);
  margin-top: 2rem;
}

/* ============ SECTION VISIBILITY ============ */
.page { display: none; }
.page.active { display: block; animation: pageFadeIn 0.25s ease; }

@keyframes pageFadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* ============ RESPONSIVE ============ */
@media (max-width: 700px) {
  .solve-it-grid { grid-template-columns: 1fr; }
  .hero { padding: 2.5rem 1.25rem 2rem; }
  .container { padding: 1.5rem 1rem 3rem; }
  .myday-timeline { padding-left: 0.5rem; }
  .sos-modal-content { width: 95%; margin: 1rem; padding: 1.5rem; }
  .quiz-card { padding: 1.5rem; }
}

/* =================================================================
   NEW FEATURES
   ================================================================= */

/* ============ SOS PANIC BUTTON ============ */
.sos-fab {
  position: fixed;
  bottom: 1.5rem;
  right: 1.5rem;
  z-index: 9999;
  width: 64px;
  height: 64px;
  border-radius: 50%;
  background: linear-gradient(135deg, #E8443A, #C0392B);
  border: none;
  color: #fff;
  font-size: 1.6rem;
  cursor: pointer;
  box-shadow: 0 4px 20px rgba(232,68,58,0.4), 0 0 40px rgba(232,68,58,0.15);
  transition: all 0.3s;
  display: flex;
  align-items: center;
  justify-content: center;
  animation: sosPulse 3s ease-in-out infinite;
}

.sos-fab:hover { transform: scale(1.1); box-shadow: 0 6px 30px rgba(232,68,58,0.6); }

@keyframes sosPulse {
  0%, 100% { box-shadow: 0 4px 20px rgba(232,68,58,0.4), 0 0 40px rgba(232,68,58,0.15); }
  50% { box-shadow: 0 4px 20px rgba(232,68,58,0.5), 0 0 60px rgba(232,68,58,0.25); }
}

.sos-fab-label {
  position: fixed;
  bottom: 2.7rem;
  right: 5.5rem;
  z-index: 9999;
  font-family: 'DM Sans', sans-serif;
  font-size: 0.78rem;
  font-weight: 600;
  color: var(--accent);
  background: var(--card-bg);
  padding: 0.35rem 0.75rem;
  border-radius: 8px;
  border: 1px solid rgba(255,107,107,0.2);
  pointer-events: none;
  opacity: 0;
  transform: translateX(8px);
  transition: all 0.3s;
}

.sos-fab:hover + .sos-fab-label { opacity: 1; transform: translateX(0); }

/* SOS Modal */
.sos-overlay {
  position: fixed;
  inset: 0;
  z-index: 10000;
  background: rgba(0,0,0,0.8);
  backdrop-filter: blur(8px);
  display: none;
  align-items: center;
  justify-content: center;
  animation: fadeIn 0.2s ease;
}
.sos-overlay.open { display: flex; }

@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

.sos-modal-content {
  background: var(--dark);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 20px;
  padding: 2rem;
  max-width: 520px;
  width: 90%;
  max-height: 90vh;
  overflow-y: auto;
  position: relative;
}

.sos-close {
  position: absolute;
  top: 1rem;
  right: 1rem;
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 1.5rem;
  cursor: pointer;
  padding: 0.25rem;
  line-height: 1;
}

.sos-title {
  font-family: 'Fredoka', sans-serif;
  font-size: 1.5rem;
  font-weight: 600;
  margin-bottom: 0.5rem;
  color: var(--accent);
}

.sos-subtitle {
  color: var(--text-muted);
  font-size: 0.92rem;
  margin-bottom: 1.5rem;
  line-height: 1.5;
}

.sos-options {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0.75rem;
  margin-bottom: 1rem;
}

.sos-option {
  background: var(--card-bg);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 14px;
  padding: 1.1rem;
  cursor: pointer;
  transition: all 0.2s;
  text-align: center;
}

.sos-option:hover {
  background: var(--card-hover);
  transform: translateY(-2px);
  border-color: rgba(255,255,255,0.12);
}

.sos-option .sos-emoji { font-size: 1.8rem; margin-bottom: 0.4rem; }
.sos-option .sos-label { font-family: 'Fredoka', sans-serif; font-size: 0.95rem; font-weight: 600; }

/* SOS Action Panel */
.sos-action {
  display: none;
  animation: fadeSlideUp 0.3s ease;
}
.sos-action.visible { display: block; }

@keyframes fadeSlideUp {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.sos-action-title {
  font-family: 'Fredoka', sans-serif;
  font-size: 1.2rem;
  font-weight: 600;
  margin-bottom: 0.75rem;
}

.sos-step {
  background: var(--card-bg);
  border-radius: 12px;
  padding: 1rem 1.25rem;
  margin-bottom: 0.6rem;
  font-size: 0.92rem;
  color: var(--text-muted);
  line-height: 1.55;
  border-left: 3px solid var(--accent);
}

.sos-step strong { color: var(--text-main); }

.sos-breathe {
  text-align: center;
  padding: 2rem;
  margin: 1rem 0;
}

.sos-breathe-circle {
  width: 120px;
  height: 120px;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(107,203,119,0.3), rgba(107,203,119,0.05));
  border: 2px solid rgba(107,203,119,0.4);
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 1rem;
  font-family: 'Fredoka', sans-serif;
  font-size: 1rem;
  font-weight: 600;
  color: #6BCB77;
  animation: breathe 8s ease-in-out infinite;
}

@keyframes breathe {
  0%, 100% { transform: scale(1); opacity: 0.7; }
  12.5% { transform: scale(1.25); opacity: 1; }
  50% { transform: scale(1.25); opacity: 1; }
  62.5% { transform: scale(1); opacity: 0.7; }
}

.sos-breathe-text {
  font-size: 0.88rem;
  color: var(--text-muted);
}

.sos-back {
  background: none;
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 999px;
  padding: 0.5rem 1.2rem;
  color: var(--text-muted);
  font-family: 'DM Sans', sans-serif;
  font-size: 0.85rem;
  cursor: pointer;
  margin-top: 0.75rem;
  transition: all 0.2s;
}
.sos-back:hover { background: rgba(255,255,255,0.06); color: var(--text-main); }

/* ============ MY DAY PLANNER ============ */
.myday-section { margin-bottom: 2rem; }

.myday-section-title {
  font-family: 'Fredoka', sans-serif;
  font-size: 1.1rem;
  font-weight: 600;
  margin-bottom: 0.75rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.myday-section-subtitle {
  font-size: 0.85rem;
  color: var(--text-muted);
  margin-bottom: 1rem;
  line-height: 1.5;
}

/* Brain Dump Input */
.braindump-input-row {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 1rem;
}

.braindump-input {
  flex: 1;
  padding: 0.75rem 1.25rem;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.1);
  background: var(--card-bg);
  color: var(--text-main);
  font-family: 'DM Sans', sans-serif;
  font-size: 0.95rem;
  outline: none;
  transition: border-color 0.2s;
}
.braindump-input:focus { border-color: var(--accent); }
.braindump-input::placeholder { color: var(--text-muted); }

.braindump-add {
  padding: 0.75rem 1.25rem;
  border-radius: 14px;
  border: none;
  background: var(--accent);
  color: #fff;
  font-family: 'DM Sans', sans-serif;
  font-size: 0.95rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;
}
.braindump-add:hover { background: #ff5252; transform: translateY(-1px); }

/* Task Items */
.task-list {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  min-height: 60px;
}

.task-item {
  background: var(--card-bg);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 12px;
  padding: 0.75rem 1rem;
  display: flex;
  align-items: center;
  gap: 0.75rem;
  animation: cardFadeIn 0.2s ease;
  transition: all 0.2s;
}

.task-item:hover { background: var(--card-hover); }

.task-done-btn {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  border: 2px solid rgba(255,255,255,0.15);
  background: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
  flex-shrink: 0;
  font-size: 0.75rem;
  color: transparent;
}

.task-item.completed .task-done-btn {
  border-color: #6BCB77;
  background: #6BCB77;
  color: #fff;
}

.task-item.completed .task-text {
  text-decoration: line-through;
  opacity: 0.5;
}

.task-text {
  flex: 1;
  font-size: 0.92rem;
  color: var(--text-main);
}

.task-color-btns {
  display: flex;
  gap: 0.25rem;
}

.task-color-btn {
  width: 22px;
  height: 22px;
  border-radius: 6px;
  border: 2px solid transparent;
  cursor: pointer;
  transition: all 0.15s;
  opacity: 0.4;
}
.task-color-btn:hover { opacity: 0.8; transform: scale(1.15); }
.task-color-btn.selected { opacity: 1; border-color: #fff; transform: scale(1.1); }

.task-color-btn.tc-red { background: var(--red); }
.task-color-btn.tc-yellow { background: var(--yellow); }
.task-color-btn.tc-blue { background: var(--blue); }
.task-color-btn.tc-green { background: var(--green); }

.task-delete {
  background: none;
  border: none;
  color: var(--text-muted);
  cursor: pointer;
  font-size: 1rem;
  opacity: 0.4;
  transition: all 0.15s;
  padding: 0.25rem;
}
.task-delete:hover { opacity: 1; color: var(--red); }

/* Task color indicator stripe */
.task-item[data-color="red"] { border-left: 3px solid var(--red); }
.task-item[data-color="yellow"] { border-left: 3px solid var(--yellow); }
.task-item[data-color="blue"] { border-left: 3px solid var(--blue); }
.task-item[data-color="green"] { border-left: 3px solid var(--green); }

/* Energy Meter */
.energy-meter {
  background: var(--card-bg);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 16px;
  padding: 1.25rem 1.5rem;
  margin: 1.5rem 0;
}

.energy-meter-title {
  font-family: 'Fredoka', sans-serif;
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 0.75rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.energy-bar-row {
  display: flex;
  gap: 0.4rem;
  margin-bottom: 0.75rem;
  height: 28px;
  border-radius: 8px;
  overflow: hidden;
  background: rgba(255,255,255,0.03);
}

.energy-segment {
  height: 100%;
  transition: width 0.4s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.7rem;
  font-weight: 700;
  color: rgba(255,255,255,0.8);
  min-width: 0;
  overflow: hidden;
}

.energy-segment.seg-red { background: var(--red); }
.energy-segment.seg-yellow { background: var(--yellow); }
.energy-segment.seg-blue { background: var(--blue); }
.energy-segment.seg-green { background: var(--green); }

.energy-legend {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  margin-bottom: 0.75rem;
}

.energy-legend-item {
  display: flex;
  align-items: center;
  gap: 0.35rem;
  font-size: 0.8rem;
  color: var(--text-muted);
}

.energy-legend-dot {
  width: 10px;
  height: 10px;
  border-radius: 3px;
  flex-shrink: 0;
}

.energy-nudge {
  font-size: 0.88rem;
  color: var(--text-muted);
  line-height: 1.55;
  padding: 0.75rem 1rem;
  background: rgba(255,107,107,0.06);
  border-radius: 10px;
  border-left: 3px solid var(--accent);
}

.energy-nudge.positive {
  background: rgba(107,203,119,0.06);
  border-left-color: #6BCB77;
}

/* My Day Stats */
.myday-stats {
  display: flex;
  gap: 0.75rem;
  margin-bottom: 1.5rem;
  flex-wrap: wrap;
}

.myday-stat {
  background: var(--card-bg);
  border-radius: 12px;
  padding: 0.85rem 1.1rem;
  flex: 1;
  min-width: 100px;
  text-align: center;
}

.myday-stat-num {
  font-family: 'Fredoka', sans-serif;
  font-size: 1.5rem;
  font-weight: 700;
}

.myday-stat-label {
  font-size: 0.75rem;
  color: var(--text-muted);
  margin-top: 0.15rem;
}

/* My Day buttons */
.myday-actions {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
  margin-top: 1rem;
}

.myday-action-btn {
  padding: 0.5rem 1rem;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.1);
  background: transparent;
  color: var(--text-muted);
  font-family: 'DM Sans', sans-serif;
  font-size: 0.82rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
}
.myday-action-btn:hover { background: rgba(255,255,255,0.06); color: var(--text-main); }
.myday-action-btn.destructive:hover { background: rgba(232,68,58,0.15); color: var(--red); border-color: rgba(232,68,58,0.3); }

/* Local storage note */
.storage-note {
  font-size: 0.78rem;
  color: #555;
  text-align: center;
  margin-top: 1.5rem;
  font-style: italic;
}

/* Empty state */
.empty-state {
  text-align: center;
  padding: 2.5rem 1rem;
  color: var(--text-muted);
}
.empty-state-emoji { font-size: 2.5rem; margin-bottom: 0.75rem; }
.empty-state-text { font-size: 0.95rem; line-height: 1.55; }

/* ============ QUIZ ============ */
.quiz-card {
  background: var(--card-bg);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 20px;
  padding: 2rem;
  max-width: 640px;
  margin: 0 auto;
}

.quiz-progress {
  display: flex;
  gap: 0.3rem;
  margin-bottom: 1.75rem;
}

.quiz-dot {
  flex: 1;
  height: 4px;
  border-radius: 4px;
  background: rgba(255,255,255,0.08);
  transition: background 0.3s;
}
.quiz-dot.filled { background: var(--accent); }

.quiz-question {
  font-family: 'Fredoka', sans-serif;
  font-size: 1.2rem;
  font-weight: 600;
  margin-bottom: 1.25rem;
  line-height: 1.4;
}

.quiz-answers {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.quiz-answer {
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 12px;
  padding: 0.85rem 1.25rem;
  cursor: pointer;
  font-family: 'DM Sans', sans-serif;
  font-size: 0.92rem;
  color: var(--text-muted);
  transition: all 0.2s;
  text-align: left;
}

.quiz-answer:hover { background: rgba(255,255,255,0.06); color: var(--text-main); border-color: rgba(255,255,255,0.15); }
.quiz-answer.selected { background: rgba(255,107,107,0.1); border-color: var(--accent); color: var(--text-main); }

/* Quiz Result */
.quiz-result {
  text-align: center;
  animation: fadeSlideUp 0.4s ease;
}

.quiz-result-icon { font-size: 3rem; margin-bottom: 0.75rem; }

.quiz-result h3 {
  font-family: 'Fredoka', sans-serif;
  font-size: 1.4rem;
  font-weight: 600;
  margin-bottom: 0.5rem;
}

.quiz-result p {
  color: var(--text-muted);
  font-size: 0.92rem;
  line-height: 1.55;
  margin-bottom: 1rem;
}

.quiz-result-strategies {
  text-align: left;
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 14px;
  padding: 1.25rem;
  margin: 1rem 0;
}

.quiz-result-strategies h4 {
  font-family: 'Fredoka', sans-serif;
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 0.6rem;
  color: var(--accent);
}

.quiz-result-strategies li {
  color: var(--text-muted);
  font-size: 0.88rem;
  line-height: 1.55;
  padding: 0.3rem 0 0.3rem 1.4rem;
  position: relative;
  list-style: none;
}

.quiz-result-strategies li::before {
  content: '‚Üí';
  position: absolute;
  left: 0;
  color: var(--accent);
}

.quiz-restart {
  margin-top: 1rem;
  padding: 0.6rem 1.5rem;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.1);
  background: transparent;
  color: var(--text-muted);
  font-family: 'DM Sans', sans-serif;
  font-size: 0.85rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
}
.quiz-restart:hover { background: rgba(255,255,255,0.06); color: var(--text-main); }

.quiz-go-btn {
  padding: 0.6rem 1.5rem;
  border-radius: 999px;
  border: none;
  background: var(--accent);
  color: #fff;
  font-family: 'DM Sans', sans-serif;
  font-size: 0.85rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  margin-top: 0.5rem;
}
.quiz-go-btn:hover { background: #ff5252; }

/* ============ LADDER TRACKER ============ */
.ladder-checkin {
  background: var(--card-bg);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 16px;
  padding: 1.25rem 1.5rem;
  margin-bottom: 1.5rem;
}

.ladder-checkin-title {
  font-family: 'Fredoka', sans-serif;
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 0.5rem;
}

.ladder-checkin-subtitle {
  font-size: 0.85rem;
  color: var(--text-muted);
  margin-bottom: 1rem;
}

.ladder-checkin-btns {
  display: flex;
  gap: 0.4rem;
  flex-wrap: wrap;
}

.ladder-checkin-btn {
  padding: 0.5rem 1rem;
  border-radius: 999px;
  border: 2px solid;
  background: transparent;
  font-family: 'DM Sans', sans-serif;
  font-size: 0.82rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
}
.ladder-checkin-btn:hover { transform: translateY(-1px); }

.ladder-checkin-btn.lcb-1 { border-color: #6BCB77; color: #6BCB77; }
.ladder-checkin-btn.lcb-1:hover, .ladder-checkin-btn.lcb-1.today-active { background: rgba(107,203,119,0.15); }
.ladder-checkin-btn.lcb-2 { border-color: #4ECDC4; color: #4ECDC4; }
.ladder-checkin-btn.lcb-2:hover, .ladder-checkin-btn.lcb-2.today-active { background: rgba(78,205,196,0.15); }
.ladder-checkin-btn.lcb-3 { border-color: #F5A623; color: #F5A623; }
.ladder-checkin-btn.lcb-3:hover, .ladder-checkin-btn.lcb-3.today-active { background: rgba(245,166,35,0.15); }
.ladder-checkin-btn.lcb-4 { border-color: #E8443A; color: #E8443A; }
.ladder-checkin-btn.lcb-4:hover, .ladder-checkin-btn.lcb-4.today-active { background: rgba(232,68,58,0.15); }
.ladder-checkin-btn.lcb-5 { border-color: #C06080; color: #C06080; }
.ladder-checkin-btn.lcb-5:hover, .ladder-checkin-btn.lcb-5.today-active { background: rgba(192,96,128,0.15); }

.ladder-history {
  margin-top: 1rem;
}

.ladder-history-title {
  font-size: 0.82rem;
  color: var(--text-muted);
  margin-bottom: 0.5rem;
  font-weight: 600;
}

.ladder-history-row {
  display: flex;
  gap: 3px;
  flex-wrap: wrap;
}

.ladder-history-dot {
  width: 28px;
  height: 28px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.65rem;
  font-weight: 700;
  color: rgba(255,255,255,0.7);
  position: relative;
}

.ladder-history-dot[title]::after {
  content: attr(title);
}

.lhd-1 { background: rgba(107,203,119,0.25); }
.lhd-2 { background: rgba(78,205,196,0.25); }
.lhd-3 { background: rgba(245,166,35,0.25); }
.lhd-4 { background: rgba(232,68,58,0.25); }
.lhd-5 { background: rgba(192,96,128,0.25); }
.lhd-empty { background: rgba(255,255,255,0.03); }

/* ============ MY TOOLS (FAVORITES) TAB ============ */
.fav-empty {
  text-align: center;
  padding: 3rem 1rem;
}

.fav-empty-emoji { font-size: 3rem; margin-bottom: 0.75rem; }

.fav-empty-text {
  color: var(--text-muted);
  font-size: 0.95rem;
  line-height: 1.55;
  max-width: 400px;
  margin: 0 auto;
}

</style>
</head>
<body>

<!-- SOS FLOATING BUTTON -->
<button class="sos-fab" onclick="openSOS()" aria-label="I need help right now">üÜò</button>
<div class="sos-fab-label">I'm struggling right now</div>

<!-- SOS MODAL -->
<div class="sos-overlay" id="sosOverlay" onclick="if(event.target===this)closeSOS()">
  <div class="sos-modal-content">
    <button class="sos-close" onclick="closeSOS()">‚úï</button>
    
    <!-- Step 1: What's happening -->
    <div id="sosStep1">
      <div class="sos-title">What's happening right now?</div>
      <div class="sos-subtitle">No judgment. Pick the closest match and I'll give you one thing to do ‚Äî just one.</div>
      <div class="sos-options">
        <div class="sos-option" onclick="showSOSAction('spiraling')">
          <div class="sos-emoji">üåÄ</div>
          <div class="sos-label">Spiraling</div>
        </div>
        <div class="sos-option" onclick="showSOSAction('paralyzed')">
          <div class="sos-emoji">üßä</div>
          <div class="sos-label">Paralyzed</div>
        </div>
        <div class="sos-option" onclick="showSOSAction('avoiding')">
          <div class="sos-emoji">üõãÔ∏è</div>
          <div class="sos-label">Avoiding</div>
        </div>
        <div class="sos-option" onclick="showSOSAction('overwhelmed')">
          <div class="sos-emoji">üî•</div>
          <div class="sos-label">Overwhelmed</div>
        </div>
        <div class="sos-option" onclick="showSOSAction('emotional')">
          <div class="sos-emoji">üåä</div>
          <div class="sos-label">Big emotions</div>
        </div>
        <div class="sos-option" onclick="showSOSAction('shame')">
          <div class="sos-emoji">üòî</div>
          <div class="sos-label">Shame spiral</div>
        </div>
      </div>
    </div>

    <!-- Action panels (one per state) -->
    <div class="sos-action" id="sos-spiraling">
      <div class="sos-action-title" style="color:#E8443A">üåÄ You're spiraling. Let's slow the spin.</div>
      <div class="sos-breathe">
        <div class="sos-breathe-circle" id="breatheCircle">Breathe</div>
        <div class="sos-breathe-text">Watch the circle. In when it grows. Out when it shrinks. That's all.</div>
      </div>
      <div class="sos-step"><strong>Now:</strong> Put your feet flat on the floor. Feel them. Name 3 things you can see right now.</div>
      <div class="sos-step"><strong>Then:</strong> Your thoughts are the Prosecutor's case ‚Äî loud, dramatic, one-sided. You don't have to believe them right now. Just file them as "unverified."</div>
      <div class="sos-step"><strong>When ready:</strong> Write down the single thought that's loudest. Just getting it out of your head takes away some of its power.</div>
      <button class="sos-back" onclick="sosGoBack()">‚Üê Back to options</button>
    </div>

    <div class="sos-action" id="sos-paralyzed">
      <div class="sos-action-title" style="color:#4D96FF">üßä You're frozen. Let's thaw one inch.</div>
      <div class="sos-step"><strong>Body first.</strong> Stand up. Right now. Just stand. You don't have to do anything else yet.</div>
      <div class="sos-step"><strong>Now:</strong> Drink a glass of water. Splash some on your face if you want. You're waking up your nervous system.</div>
      <div class="sos-step"><strong>The absurdly small step:</strong> Don't think about the whole task. What's the smallest physical action? Not "do the project" but "open the file." Not "clean the house" but "pick up one thing." Do just that.</div>
      <div class="sos-step"><strong>Remember:</strong> You don't need to feel motivated. You need 51% ‚Äî just enough swing votes. Action creates motivation, not the other way around.</div>
      <button class="sos-back" onclick="sosGoBack()">‚Üê Back to options</button>
    </div>

    <div class="sos-action" id="sos-avoiding">
      <div class="sos-action-title" style="color:#F5A623">üõãÔ∏è You're hiding in the Blue. No judgment ‚Äî let's nudge.</div>
      <div class="sos-step"><strong>Check in:</strong> Is this Blue recharging you, or numbing you? Be honest. If it was recharging, you wouldn't feel guilty about it.</div>
      <div class="sos-step"><strong>The deal:</strong> Set a timer for 15 minutes. Do one Yellow task ‚Äî the most boring, annoying one you're avoiding. 15 minutes. That's 900 seconds. You've sat through longer YouTube videos.</div>
      <div class="sos-step"><strong>Then:</strong> After 15 minutes, you've earned your Blue time guilt-free. Or ‚Äî you might find you want to keep going. Either outcome is a win.</div>
      <div class="sos-step"><strong>Challenge the lie:</strong> "I'll do it later" means "I'll feel worse about it later." You know this. 15 minutes. Go.</div>
      <button class="sos-back" onclick="sosGoBack()">‚Üê Back to options</button>
    </div>

    <div class="sos-action" id="sos-overwhelmed">
      <div class="sos-action-title" style="color:#E8443A">üî• Too much. Way too much. Let's put out one fire.</div>
      <div class="sos-step"><strong>Brain dump:</strong> Grab paper or open a note. Write everything in your head. Don't organize. Don't prioritize. Just dump. Set a 3-minute timer and write until it rings.</div>
      <div class="sos-step"><strong>Now circle THREE.</strong> Just three things that actually matter today. Everything else is tomorrow's problem. It will still be there ‚Äî it's not going anywhere.</div>
      <div class="sos-step"><strong>Pick ONE of the three.</strong> Define the first physical step. Make it absurdly small.</div>
      <div class="sos-step"><strong>Catch the thought:</strong> "If I can't do it all, why do anything?" ‚Äî that's all-or-nothing thinking. Doing one thing is infinitely more than zero things.</div>
      <button class="sos-back" onclick="sosGoBack()">‚Üê Back to options</button>
    </div>

    <div class="sos-action" id="sos-emotional">
      <div class="sos-action-title" style="color:#FF6B6B">üåä Big feelings are crashing in. Let's ride the wave.</div>
      <div class="sos-breathe">
        <div class="sos-breathe-circle">Breathe</div>
        <div class="sos-breathe-text">4 seconds in... 7 seconds hold... 8 seconds out. This activates your body's brake pedal.</div>
      </div>
      <div class="sos-step"><strong>Name it and rate it:</strong> "This is a ___ and it's a __/10 right now." Naming creates distance. You're observing the wave, not drowning in it.</div>
      <div class="sos-step"><strong>Remind yourself:</strong> The feeling is real. The story your brain is telling about it might not be. Emotions are waves ‚Äî they peak and they pass. This one will too.</div>
      <div class="sos-step"><strong>Don't act on it yet.</strong> Give yourself 24 hours before making any decision based on this feeling. Your Defense Attorney needs time to prepare their case.</div>
      <button class="sos-back" onclick="sosGoBack()">‚Üê Back to options</button>
    </div>

    <div class="sos-action" id="sos-shame">
      <div class="sos-action-title" style="color:#8E6FBF">üòî Shame is loud right now. It's lying to you.</div>
      <div class="sos-step"><strong>Hear this:</strong> You are not your ADHD. You are not your worst moment. You are a person dealing with a brain that works differently ‚Äî and you're here, trying. That counts.</div>
      <div class="sos-step"><strong>The ghosts are talking.</strong> What are they saying? Write it down. "You always..." "You never..." "Everyone else can..." ‚Äî get it out of your head and onto paper where it looks less convincing.</div>
      <div class="sos-step"><strong>Now ask:</strong> If your best friend told you they felt this way, would you agree with the ghosts? Or would you say something kinder? Say that kinder thing to yourself. Out loud if you can.</div>
      <div class="sos-step"><strong>One act of care:</strong> Not productivity. Care. Make tea. Step outside for one minute of fresh air. Text someone you trust. You don't have to earn kindness toward yourself.</div>
      <button class="sos-back" onclick="sosGoBack()">‚Üê Back to options</button>
    </div>
  </div>
</div>

<!-- HERO -->
<div class="hero">
  <h1>Name Your Beast</h1>
  <p class="subtitle">A complete map of ADHD traits, what they feel like, and the exact tools to manage them ‚Äî drawn from two leading books on adult ADHD.</p>
  <p class="source-note">Sources: <em>Your Brain's Not Broken</em> (Tamara Rosier, PhD) &amp; <em>The Adult ADHD Tool Kit</em> (Ramsay &amp; Rostain)</p>
</div>

<!-- NAV -->
<div class="nav-bar">
  <button class="nav-btn active" data-page="traits">üß† Traits &amp; Tools</button>
  <button class="nav-btn" data-page="grid">üü•üü®üü¶üü© Solve-It Grid</button>
  <button class="nav-btn" data-page="ladder">ü™ú Emotional Ladder</button>
  <button class="nav-btn" data-page="patterns">üîÅ Patterns</button>
  <button class="nav-btn" data-page="cbt">‚öñÔ∏è CBT Toolkit</button>
  <button class="nav-btn" data-page="naming">üí° Name Your ADHD</button>
  <button class="nav-btn" data-page="quiz">üîç Which Pattern?</button>
  <button class="nav-btn nav-myday" data-page="myday">üìã My Day</button>
  <button class="nav-btn nav-fav" data-page="favs">‚≠ê My Tools</button>
</div>

<!-- MAIN CONTENT -->
<div class="container">

<!-- ==================== PAGE: TRAITS & TOOLS ==================== -->
<div class="page active" id="page-traits">
  <div class="section-header">
    <h2>ADHD Traits ‚Üí Tools Map</h2>
    <p>Click any trait to reveal what it is, how it feels, and step-by-step tools to manage it. Hit ‚≠ê on any tool to save it to your personal toolkit.</p>
  </div>

  <div class="search-box">
    <input type="text" id="traitSearch" placeholder="Search traits, feelings, or tools‚Ä¶" oninput="filterTraits()">
  </div>

  <div class="filter-bar" id="categoryFilter">
    <button class="filter-chip active" data-cat="all">All</button>
    <button class="filter-chip" data-cat="attention">Attention</button>
    <button class="filter-chip" data-cat="emotion">Emotion</button>
    <button class="filter-chip" data-cat="executive">Executive Function</button>
    <button class="filter-chip" data-cat="motivation">Motivation</button>
    <button class="filter-chip" data-cat="thinking">Thinking</button>
    <button class="filter-chip" data-cat="social">Social</button>
  </div>

  <div class="trait-grid" id="traitGrid"></div>
</div>

<!-- ==================== PAGE: SOLVE-IT GRID ==================== -->
<div class="page" id="page-grid">
  <div class="section-header">
    <h2>The Solve-It Grid</h2>
    <p>Dr. Rosier's framework for understanding how you categorize tasks based on two axes: <strong>Fun vs. Not Fun</strong> and <strong>Emotionally Stimulating vs. Not Stimulating</strong>. Understanding where a task sits on this grid helps you choose the right strategy.</p>
  </div>

  <div class="solve-it-grid">
    <div class="grid-quad q-red">
      <h3>üî¥ Red Quadrant</h3>
      <p><strong>Not Fun + High Emotional Intensity</strong></p>
      <p style="margin:0.5rem 0">Tasks you dread but tackle through adrenaline, anger, or panic. Procrastinating until deadline pressure kicks in lives here. It feels energizing at first but is exhausting and addictive.</p>
      <p><strong>Examples:</strong> Last-minute projects, tax deadlines, confrontations, crisis management</p>
      <p style="margin-top:0.5rem"><strong>Battery impact:</strong> Drains rapidly. Feels productive but burns you out.</p>
      <ul style="margin-top:0.5rem">
        <li>Break tasks into Yellow-sized pieces before they become Red emergencies</li>
        <li>Set midday alarms for system checks (posture, hydration, tension)</li>
        <li>Challenge the false belief: "I work best under pressure"</li>
      </ul>
    </div>

    <div class="grid-quad q-green">
      <h3>üü¢ Green Quadrant</h3>
      <p><strong>Fun + High Emotional Intensity</strong></p>
      <p style="margin:0.5rem 0">Your happy place. Activities that are enjoyable AND emotionally meaningful. Green recharges your battery fastest. Many people with ADHD deny themselves Green time because they feel they haven't "earned" it.</p>
      <p><strong>Examples:</strong> Family dinners, creative projects, nature walks, deep hobbies, meaningful conversations</p>
      <p style="margin-top:0.5rem"><strong>Battery impact:</strong> Recharges fastest. Reconnects you with your values.</p>
      <ul style="margin-top:0.5rem">
        <li>Schedule Green time deliberately ‚Äî you deserve it</li>
        <li>Use Green as a reward after Yellow/Red tasks</li>
        <li>Notice when you deny yourself Green and challenge that impulse</li>
      </ul>
    </div>

    <div class="grid-quad q-yellow">
      <h3>üü° Yellow Quadrant</h3>
      <p><strong>Not Fun + Low Emotional Intensity</strong></p>
      <p style="margin:0.5rem 0">Boring, repetitive tasks that drain your will to live. They feel like they'll take forever but actually consume less energy than Red. The ADHD brain avoids these like the plague.</p>
      <p><strong>Examples:</strong> Homework, bills, paperwork, cleaning, data entry, emails</p>
      <p style="margin-top:0.5rem"><strong>Battery impact:</strong> Slow drain. Feels like total drain, but isn't.</p>
      <ul style="margin-top:0.5rem">
        <li>Set a timer for 15-20 minutes ‚Äî Yellow doesn't last forever</li>
        <li>Break into a specific "how-to" list (even absurdly small steps)</li>
        <li>Try the Yellow-Blue game: 30 min work, 10 min Blue break</li>
        <li>Pair Yellow with a pleasant activity (music, podcast, favorite drink)</li>
      </ul>
    </div>

    <div class="grid-quad q-blue">
      <h3>üîµ Blue Quadrant</h3>
      <p><strong>Fun + Low Emotional Intensity</strong></p>
      <p style="margin:0.5rem 0">Low-key relaxation. Phone games, Netflix, scrolling. Recharges slowly, but too much Blue becomes a trap ‚Äî the "molasses swamp" effect. Healthy Blue is restorative. Unhealthy Blue is numbing.</p>
      <p><strong>Examples:</strong> Social media, TV, gaming, lying in a hammock, light browsing</p>
      <p style="margin-top:0.5rem"><strong>Battery impact:</strong> Slow recharge if healthy. Battery drain if overdone.</p>
      <ul style="margin-top:0.5rem">
        <li>Set boundaries on Blue time with a timer</li>
        <li>Ask: "Is this Blue recharging me or numbing me?"</li>
        <li>Upgrade to Green when possible ‚Äî it recharges faster</li>
        <li>Use Blue as a scheduled reward, not an escape</li>
      </ul>
    </div>
  </div>

  <div class="tool-card" style="margin-top:1.5rem">
    <h4>üîë Using the Grid ‚Äî Quick Practice</h4>
    <ol class="steps">
      <li>Pick a task you're avoiding right now</li>
      <li>Ask: Is it fun or not fun? How emotionally stimulating is it?</li>
      <li>Place it on the grid ‚Äî Red, Yellow, Blue, or Green?</li>
      <li>Ask: Why is this task in this quadrant? What makes it feel this way?</li>
      <li>Choose the matching strategy from above</li>
      <li>Set a timer, define a first step, and begin. Re-check after the timer rings.</li>
    </ol>
  </div>
</div>

<!-- ==================== PAGE: EMOTIONAL LADDER ==================== -->
<div class="page" id="page-ladder">
  <div class="section-header">
    <h2>The Emotional Health Ladder</h2>
    <p>Created by Rosier &amp; Gott, this 5-level framework helps you see where you are emotionally so you can choose what to do next. You naturally move up and down daily. The goal isn't perfection ‚Äî it's awareness.</p>
  </div>

  <!-- Ladder Check-in tracker -->
  <div class="ladder-checkin">
    <div class="ladder-checkin-title">üìç Where are you right now?</div>
    <div class="ladder-checkin-subtitle">Tap a level to log today's check-in. Tracking helps you spot patterns over time.</div>
    <div class="ladder-checkin-btns">
      <button class="ladder-checkin-btn lcb-1" onclick="logLadder(1)">‚òÄÔ∏è 1 ‚Äî Present</button>
      <button class="ladder-checkin-btn lcb-2" onclick="logLadder(2)">üå§Ô∏è 2 ‚Äî Attending</button>
      <button class="ladder-checkin-btn lcb-3" onclick="logLadder(3)">‚õÖ 3 ‚Äî Autopilot</button>
      <button class="ladder-checkin-btn lcb-4" onclick="logLadder(4)">üåßÔ∏è 4 ‚Äî Survival</button>
      <button class="ladder-checkin-btn lcb-5" onclick="logLadder(5)">üå©Ô∏è 5 ‚Äî Delusional</button>
    </div>
    <div class="ladder-history" id="ladderHistory"></div>
  </div>

  <div class="ladder">
    <div class="ladder-rung l1" onclick="this.classList.toggle('open')">
      <h4>‚òÄÔ∏è Level 1: Present &amp; Calm</h4>
      <div class="detail">
        <p><strong>Awareness:</strong> Fully present, responding to life as it happens. Not fixated on threats.<br>
        <strong>Attention:</strong> Focused on what's actually happening. Not defensive.<br>
        <strong>Emotional Voice:</strong> A quiet guide, not a dictator. You're attuned to it.<br>
        <strong>Body:</strong> Present, awake, relaxed in mind, heart, and body.<br>
        <strong>ADHD Symptoms:</strong> Still present but managed with mindfulness, planning, and problem solving.<br>
        <strong>Relationships:</strong> You respect and value people, and show it through words and actions.</p>
        <p style="margin-top:0.5rem"><strong>What helps you stay here:</strong> Regular Green time, good sleep, awareness practices, knowing your patterns, self-compassion.</p>
      </div>
    </div>
    <div class="ladder-rung l2" onclick="this.classList.toggle('open')">
      <h4>üå§Ô∏è Level 2: Attending To</h4>
      <div class="detail">
        <p><strong>Awareness:</strong> Feeling good, managing life, but not quite Level 1 awareness.<br>
        <strong>Attention:</strong> More open and attuned to yourself and your environment.<br>
        <strong>Emotional Voice:</strong> Informative, not shouting. It guides without taking over.<br>
        <strong>Body:</strong> Breathing relaxed. Not in fight-or-flight.<br>
        <strong>ADHD Symptoms:</strong> Identified and managed with strategies. Used carefully and consistently.<br>
        <strong>Relationships:</strong> Looking for win-win solutions.</p>
        <p style="margin-top:0.5rem"><strong>What helps you climb here:</strong> Using the Solve-It Grid, breathing exercises, catching automatic thoughts, scheduled task planning, self-monitoring.</p>
      </div>
    </div>
    <div class="ladder-rung l3" onclick="this.classList.toggle('open')">
      <h4>‚õÖ Level 3: Autopilot</h4>
      <div class="detail">
        <p><strong>Awareness:</strong> Driven by compulsive, unconscious drives. Low self-awareness radar.<br>
        <strong>Attention:</strong> Impulsive decisions. Focused on action and productivity, not strategy.<br>
        <strong>Emotional Voice:</strong> Partitioned in a "not now" response. Will burst out if obstacles hit.<br>
        <strong>Body:</strong> Fight-or-flight response activated. Heart rate up, cortisol flowing, energy spiking from adrenaline.<br>
        <strong>ADHD Symptoms:</strong> Using fight-or-flight as a coping mechanism. Trapped in reactive patterns. Short-term memory even less reliable.<br>
        <strong>Relationships:</strong> "You do your job so I can do mine." Getting your own way feels very important.</p>
        <p style="margin-top:0.5rem"><strong>Most people live here most days.</strong> The danger is that any unexpected bump drops you to Level 4.</p>
      </div>
    </div>
    <div class="ladder-rung l4" onclick="this.classList.toggle('open')">
      <h4>üåßÔ∏è Level 4: Survival</h4>
      <div class="detail">
        <p><strong>Awareness:</strong> Reduced to scanning for threats. No self-awareness. Fully instinctive.<br>
        <strong>Attention:</strong> Focused on survival and getting basic needs met. Self-indulgent ‚Äî doing whatever feels needed, healthy or not.<br>
        <strong>Emotional Voice:</strong> Commandeering. Demands emotional needs be met NOW. Fear and anxiety dominate.<br>
        <strong>Body:</strong> On high alert. Adapts to chronic stress. Poor sleep, weight changes.<br>
        <strong>ADHD Symptoms:</strong> Constantly putting out fires. Irritable, frustrated, poor concentration. Black-and-white thinking.<br>
        <strong>Relationships:</strong> Self-centered. Very critical of others.</p>
        <p style="margin-top:0.5rem"><strong>How to climb back:</strong> Deep breathing. Text a trusted person. Take one slow breath. Name what you're feeling. Don't try to fix everything ‚Äî just get back to Level 3 first.</p>
      </div>
    </div>
    <div class="ladder-rung l5" onclick="this.classList.toggle('open')">
      <h4>üå©Ô∏è Level 5: Delusional</h4>
      <div class="detail">
        <p><strong>Awareness:</strong> Complete lack of awareness. Potential for self-destructive decisions.<br>
        <strong>Attention:</strong> On constant high alert for threats to emotional safety.<br>
        <strong>Emotional Voice:</strong> Fatigued but still screaming. Intense emotions prevail everywhere. Fear, depression, exhaustion.<br>
        <strong>Body:</strong> Resources drained. Body no longer has strength to fight stress. Feeling hopeless.<br>
        <strong>ADHD Symptoms:</strong> Emotionally volatile, oversensitive, oppositional.<br>
        <strong>Relationships:</strong> Either very clingy or very distant and critical. Projecting frustration onto others.</p>
        <p style="margin-top:0.5rem"><strong>This is not permanent.</strong> You can climb back. Professional support (therapist, coach) is recommended here. Start with one small act of self-care. One breath at a time.</p>
      </div>
    </div>
  </div>
</div>

<!-- ==================== PAGE: PATTERNS ==================== -->
<div class="page" id="page-patterns">
  <div class="section-header">
    <h2>Predictable Patterns</h2>
    <p>Dr. Rosier identified these common energy patterns that keep us stuck. Recognizing your pattern is the first step to breaking it. (Not sure which one you are? Try the <a href="#" onclick="switchToPage('quiz');return false" style="color:var(--accent)">Which Pattern?</a> quiz.)</p>
  </div>

  <div class="trait-grid" id="patternGrid"></div>
</div>

<!-- ==================== PAGE: CBT TOOLKIT ==================== -->
<div class="page" id="page-cbt">
  <div class="section-header">
    <h2>The CBT Toolkit</h2>
    <p>From Ramsay &amp; Rostain's research-backed cognitive behavioral approach. These are the specific, teachable techniques for managing ADHD day-to-day.</p>
  </div>

  <div class="trait-grid" id="cbtGrid"></div>
</div>

<!-- ==================== PAGE: NAME YOUR ADHD ==================== -->
<div class="page" id="page-naming">
  <div class="section-header">
    <h2>Name Your ADHD</h2>
    <p>Dr. Rosier's powerful concept: creating a metaphor for your ADHD helps you externalize it, understand it, and develop strategies. The metaphor you choose literally changes how you think about solutions.</p>
  </div>

  <div class="tool-card" style="margin-bottom:1.5rem">
    <h4>üî¨ Why Naming Works (The Science)</h4>
    <p style="color:var(--text-muted);font-size:0.9rem;line-height:1.6;margin-top:0.5rem">Research shows metaphors change thinking at an unconscious level. In one study, people who read about crime described as a <em>"beast"</em> suggested control strategies (more police, stricter penalties). Those who read about crime as a <em>"disease"</em> suggested treatment strategies (addressing root causes). The metaphor you use for your ADHD shapes the solutions you'll gravitate toward.</p>
  </div>

  <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1rem;margin-bottom:2rem">
    <div class="tool-card">
      <h4>üßù The Mischievous Elf (Claire)</h4>
      <p style="color:var(--text-muted);font-size:0.88rem;line-height:1.5;margin-top:0.4rem">Creeps in and moves things. Plays with time using a remote ‚Äî fast-forward or slow motion. <strong>Strategy:</strong> Outsmart the elf. Anticipate where it will strike. Set external systems it can't tamper with.</p>
    </div>
    <div class="tool-card">
      <h4>üë∂ The Dirty Baby (Melanie)</h4>
      <p style="color:var(--text-muted);font-size:0.88rem;line-height:1.5;margin-top:0.4rem">"No matter how many times I wash him, he's always messy." The part of yourself you can't quite trust. <strong>Strategy:</strong> Care for it with patience. Accept it needs constant tending. Don't hate it ‚Äî tend to it.</p>
    </div>
    <div class="tool-card">
      <h4>üç´ Lucille Ball on the Conveyor Belt (Kelly)</h4>
      <p style="color:var(--text-muted);font-size:0.88rem;line-height:1.5;margin-top:0.4rem">"Either I'm hurling chocolate at someone, or the conveyor belt is coming so fast I'm stuffing chocolates down my shirt." <strong>Strategy:</strong> Manage the conveyor speed (task load). Learn not to throw chocolate (emotional regulation).</p>
    </div>
    <div class="tool-card">
      <h4>üìù The Test You Didn't Study For (Rick)</h4>
      <p style="color:var(--text-muted);font-size:0.88rem;line-height:1.5;margin-top:0.4rem">"I hate that I don't feel prepared for anything, even when I try to plan." Lives behind a mask to hide shame. <strong>Strategy:</strong> Slow down. Drop the mask. Check in with real thoughts and feelings before making plans.</p>
    </div>
    <div class="tool-card">
      <h4>üèÉ The Three-Legged Race (Dr. Rosier)</h4>
      <p style="color:var(--text-muted);font-size:0.88rem;line-height:1.5;margin-top:0.4rem">Tied to the ADHD version of herself who stops mid-race to examine a dandelion. "If I could just run without her, I would do well." <strong>Strategy:</strong> Accept the partner. Give her pep talks. Work <em>with</em> her, not against her.</p>
    </div>
    <div class="tool-card" style="background:rgba(255,107,107,0.08);border-color:rgba(255,107,107,0.2)">
      <h4>‚úèÔ∏è Create Your Own Metaphor</h4>
      <p style="color:var(--text-muted);font-size:0.88rem;line-height:1.5;margin-top:0.4rem">How do <em>you</em> experience your ADHD? What word picture captures how it feels? There's no wrong answer. Your metaphor helps you externalize ADHD ‚Äî so you can address the parts of it that frustrate you most, without making it "all of who you are."</p>
    </div>
  </div>
</div>

<!-- ==================== PAGE: QUIZ ==================== -->
<div class="page" id="page-quiz">
  <div class="section-header">
    <h2>Which Pattern Am I?</h2>
    <p>Answer 6 quick questions to discover your dominant ADHD energy pattern and get targeted strategies. There's no wrong answer ‚Äî pick what resonates most.</p>
  </div>

  <div class="quiz-card" id="quizCard"></div>
</div>

<!-- ==================== PAGE: MY DAY ==================== -->
<div class="page" id="page-myday">
  <div class="section-header">
    <h2>My Day</h2>
    <p>The Solve-It Grid in action. Dump your tasks, color them, and watch your energy balance. Resets daily ‚Äî no guilt from yesterday. <span style="color:#6BCB77">Your tasks are saved in this browser.</span></p>
  </div>

  <!-- Stats -->
  <div class="myday-stats" id="mydayStats">
    <div class="myday-stat">
      <div class="myday-stat-num" id="statTotal">0</div>
      <div class="myday-stat-label">Tasks</div>
    </div>
    <div class="myday-stat">
      <div class="myday-stat-num" id="statDone" style="color:#6BCB77">0</div>
      <div class="myday-stat-label">Done</div>
    </div>
    <div class="myday-stat">
      <div class="myday-stat-num" id="statStreak" style="color:#FFD93D">0</div>
      <div class="myday-stat-label">Day streak</div>
    </div>
  </div>

  <!-- Energy Meter -->
  <div class="energy-meter" id="energyMeter">
    <div class="energy-meter-title">üîã Energy Balance</div>
    <div class="energy-bar-row" id="energyBar"></div>
    <div class="energy-legend">
      <div class="energy-legend-item"><div class="energy-legend-dot" style="background:var(--red)"></div>Red (drains fast)</div>
      <div class="energy-legend-item"><div class="energy-legend-dot" style="background:var(--yellow)"></div>Yellow (slow drain)</div>
      <div class="energy-legend-item"><div class="energy-legend-dot" style="background:var(--blue)"></div>Blue (slow recharge)</div>
      <div class="energy-legend-item"><div class="energy-legend-dot" style="background:var(--green)"></div>Green (fast recharge)</div>
    </div>
    <div class="energy-nudge" id="energyNudge"></div>
  </div>

  <!-- Brain Dump -->
  <div class="myday-section">
    <div class="myday-section-title">üß† Brain Dump</div>
    <div class="myday-section-subtitle">Get it all out. Don't organize ‚Äî just type and add. Then color each task by quadrant.</div>
    <div class="braindump-input-row">
      <input type="text" class="braindump-input" id="braindumpInput" placeholder="What's on your mind? Add a task‚Ä¶" onkeydown="if(event.key==='Enter')addTask()">
      <button class="braindump-add" onclick="addTask()">+ Add</button>
    </div>
    <div class="task-list" id="taskList"></div>
  </div>

  <!-- Actions -->
  <div class="myday-actions">
    <button class="myday-action-btn" onclick="carryForward()">üì¶ Carry forward unfinished</button>
    <button class="myday-action-btn destructive" onclick="clearDay()">üóëÔ∏è Fresh start</button>
  </div>

  <div class="storage-note">Your tasks are saved in this browser on this device.</div>
</div>

<!-- ==================== PAGE: MY TOOLS (FAVORITES) ==================== -->
<div class="page" id="page-favs">
  <div class="section-header">
    <h2>‚≠ê My Tools</h2>
    <p>Your personal toolkit ‚Äî the strategies you've saved from across all sections. These are the ones that work for <em>you</em>.</p>
  </div>

  <div id="favsContainer"></div>
</div>

</div><!-- /container -->

<div class="footer">
  Content synthesized from <em>Your Brain's Not Broken</em> by Tamara Rosier, PhD (2021) and <em>The Adult ADHD Tool Kit</em> by J. Russell Ramsay &amp; Anthony L. Rostain (2015). This is an educational reference, not medical advice.
</div>

<script>
// ============ DATA ============
const traits = [
  {
    id: "emotional-dysregulation",
    icon: "üåä", color: "#FF6B6B", cat: "emotion",
    title: "Emotional Dysregulation",
    aka: "The Angry Neighbor / Big Emotions / Flooding",
    what: "Instead of a calm 'butler' (prefrontal cortex) managing your responses, people with ADHD have an 'angry neighbor' in the emotional centers of the brain who reacts first. Emotions hit harder, faster, and last longer than expected. A store clerk's comment can ruin your whole day.",
    feel: "Overwhelming sadness from minor setbacks. Explosive frustration over small obstacles. Crying when you don't feel sad. Emotions that feel disproportionate to the situation. Embarrassment at the strength of your own reactions.",
    tools: [
      { name: "4-7-8 Breathing", steps: ["Inhale slowly through your nose for 4 seconds", "Hold your breath for 7 seconds", "Exhale slowly through your mouth for 8 seconds", "Repeat 3-4 times. This activates your parasympathetic nervous system and interrupts the fight-or-flight cascade"], hasTimer: true, timerSec: 19 },
      { name: "Name the Intensity (1-10 Scale)", steps: ["When emotion floods in, pause and rate it: 'This is a 7 right now'", "Naming it creates distance ‚Äî you're observing the emotion instead of being swallowed by it", "Watch it come down. Emotions are waves, not permanent states", "Remind yourself: the emotion is real, but it's not the whole picture"] },
      { name: "Emotional Ladder Check-In", steps: ["Ask: What level am I on right now? (1=Calm, 3=Autopilot, 5=Delusional)", "If you're at Level 4-5, don't try to solve anything ‚Äî just stabilize", "One slow breath. Name what you feel. Don't act on it yet", "Goal: get back to Level 3 first, then Level 2"] },
      { name: "Method Acting (Act 'As If')", steps: ["From the CBT Toolkit: act opposite to your current emotion", "Smile if you feel angry. Clap your hands and say 'OK, let's go' if you feel stuck", "This isn't fake ‚Äî it's priming your brain for a different response", "Combined with a defined first step, it breaks the emotional paralysis loop"] }
    ]
  },
  {
    id: "time-blindness",
    icon: "‚è∞", color: "#F5A623", cat: "executive",
    title: "Time Blindness",
    aka: "The Broken Clock / Now vs. Not Now",
    what: "People with ADHD don't experience time the way neurotypicals do. There's essentially only two time zones: NOW and NOT NOW. Time warps ‚Äî sometimes it flies, sometimes it crawls. Estimating how long things take is nearly impossible. You're perpetually late or too early.",
    feel: "Shocked that 3 hours passed. Chronic lateness despite trying. Panic when deadlines appear 'suddenly.' Feeling like time is slippery and uncontrollable. Guilt about always running behind.",
    tools: [
      { name: "External Time Anchors", steps: ["Use analog clocks (the visual sweep of hands shows time passing spatially)", "Set multiple alarms: warning alarm, transition alarm, 'leave NOW' alarm", "Use visual timers (Time Timer, hourglass, or a pig-shaped kitchen timer)", "Place clocks in every room ‚Äî make time visible"] },
      { name: "Time Estimation Training", steps: ["Before starting a task, write down how long you think it will take", "Set a timer and do the task", "Compare your estimate to reality", "Dr. Rosier's rule: multiply your estimate by 3 ‚Äî that's closer to reality", "Over time, this builds a more accurate internal clock"], hasTimer: true, timerSec: 600 },
      { name: "Reframe Time (CBT Approach)", steps: ["Instead of '10 minutes' think '600 seconds' ‚Äî it sounds different and feels manageable", "Compare: 'I've sat through 15 minutes of boring commercials. I can work on this for 15 minutes.'", "Set start AND end times for every task ‚Äî makes it finite", "Use the laptop battery trick: unplug and use the dying battery as your countdown timer"], hasTimer: true, timerSec: 600 },
      { name: "Buffer Time Planning", steps: ["Add 50% more time than you think you need between activities", "Include travel time, transition time, and 'finding my keys' time", "Schedule fewer tasks than you think you can handle ‚Äî underschedule", "A useful rule: 'If I was 15 minutes early for my train, I wouldn't think that's long. I can work on this for that long.'"] }
    ]
  },
  {
    id: "working-memory",
    icon: "üß©", color: "#4D96FF", cat: "executive",
    title: "Working Memory Deficits",
    aka: "The Missing Butler / The Leaky Bucket",
    what: "Your prefrontal cortex (PFC) should act like a calm, organized butler ‚Äî holding information, making plans, managing impulses. In ADHD, this butler is unreliable. Information drops out of short-term memory. You walk into a room and forget why. You lose your train of thought mid-sentence.",
    feel: "Forgetting what you were just about to do. Losing items constantly. Walking into rooms with no memory of why. Difficulty holding multiple instructions. Feeling 'scattered' or like thoughts evaporate.",
    tools: [
      { name: "Externalize Everything", steps: ["If it's not written down, it doesn't exist. Write it immediately.", "Use ONE capture system (notebook, phone app, or voice memo)", "The daily planner is your external working memory ‚Äî consult it constantly", "Post-it notes, whiteboards, and visible reminders compensate for the missing butler"] },
      { name: "Comprehensive To-Do List ‚Üí Daily To-Do List", steps: ["Keep a master 'brain dump' list of everything (Comprehensive To-Do)", "Each morning, pull 3-5 specific items onto today's Daily To-Do List", "Define tasks in behavioral terms: not 'work on project' but 'open document and write 3 paragraphs'", "Review the Daily To-Do List early and often throughout the day"] },
      { name: "Leaving Breadcrumbs for Future You", steps: ["When stopping a task, jot down the very next step you'd take", "Example: 'Next: write the paragraph about methodology findings'", "This eliminates the restart cost of 'where was I?' next time", "Think of it as a gift to your future self ‚Äî they'll thank you"] },
      { name: "'Enter the Room with a Plan'", steps: ["Before opening email, know what you're looking for", "Before going to the store, have the list in hand", "Before starting a meeting, know your 1-2 goals", "This pre-loading compensates for working memory dropping things mid-task"] }
    ]
  },
  {
    id: "hyperfocus",
    icon: "üéØ", color: "#4ECDC4", cat: "attention",
    title: "Hyperfocus",
    aka: "The Tunnel / The Flow Trap",
    what: "The flip side of distraction ‚Äî when something captures your interest, you can lock onto it so intensely that hours vanish. You don't eat, don't notice people talking to you, and lose track of everything else. It's often mistaken for selfishness or rudeness. It's actually your brain's reward system finding a dopamine goldmine.",
    feel: "Intense, locked-in concentration that feels amazing. Losing all sense of time and surroundings. Irritation when interrupted. Skipping meals and bathroom breaks. Guilt afterward when you realize what you neglected.",
    tools: [
      { name: "Structured Hyperfocus Sessions", steps: ["Set a timer BEFORE you start ‚Äî give yourself permission to dive deep, but with a boundary", "Tell people around you: 'I'm going deep for the next 2 hours'", "Set alarms at intervals (every 45 min) for hydration, posture, bathroom", "When the final timer rings, stop. Save your breadcrumbs (next-step notes) and transition"], hasTimer: true, timerSec: 2700 },
      { name: "Environmental Interrupts", steps: ["Use multiple alarms with different sounds", "Ask a partner/roommate to physically check on you at set times", "Put a sticky note on your monitor: 'Check the time'", "Use apps that force screen breaks (like 20-20-20 rule apps)"] }
    ]
  },
  {
    id: "distractibility",
    icon: "ü¶ã", color: "#A78BFA", cat: "attention",
    title: "Distractibility",
    aka: "And Then PING! Goes My Brain / The Butterfly Chase",
    what: "Your brain's filtering system doesn't gate stimuli well. Everything comes in at equal volume ‚Äî the important meeting AND the buzzing fly AND the thought about dinner AND the song stuck in your head. Dr. Rosier calls this the 'PING!' ‚Äî your brain constantly pinging to new stimuli.",
    feel: "Inability to block out background noise or movement. Thoughts jumping from topic to topic. Starting tasks and immediately getting pulled away. Feeling like your brain has 30 browser tabs open. Exhaustion from the constant mental noise.",
    tools: [
      { name: "Stimulus Control (Environmental Engineering)", steps: ["Remove or minimize known distractions BEFORE starting work", "Phone on silent, in another room (not just face-down)", "Close all unnecessary browser tabs and apps", "Use noise-canceling headphones or white noise", "Face away from windows and high-traffic areas", "Create a dedicated 'work station' that your brain associates with focus"] },
      { name: "Implementation Plans (If-Then)", steps: ["Before starting: predict your most likely distractions", "Create If-Then plans: 'If I get a text, then I will check it after my 30-min timer'", "'If I think of something else I need to do, then I will write a quick note and keep working'", "'If a friend walks by, then I will say I'm busy and will catch up later'", "These pre-made decisions reduce the cognitive load of resisting temptation in the moment"] },
      { name: "Escape Behavior Awareness", steps: ["Write down your 'usual suspects' ‚Äî the things you do INSTEAD of the priority task", "Common ones: email, social media, snacking, cleaning, 'quick' errands", "When you catch yourself doing one, don't beat yourself up ‚Äî use it as a CUE", "The impulse to escape IS your signal to use your coping tools", "Transform escapes into rewards: 'I'll check Instagram AFTER my 10 minutes on this task'"] }
    ]
  },
  {
    id: "impulsivity",
    icon: "‚ö°", color: "#FFD93D", cat: "executive",
    title: "Impulsivity",
    aka: "The Blurter / Ready-Fire-Aim",
    what: "The PFC's job includes impulse management ‚Äî putting a pause between stimulus and response. In ADHD, that pause is shortened or missing. You blurt things out, make snap purchases, interrupt conversations, or make decisions you regret. It's not a character flaw ‚Äî it's an executive function deficit.",
    feel: "Saying things you instantly regret. Impulse buying. Interrupting others mid-sentence. Making snap decisions without thinking through consequences. Feeling like you can't stop yourself even when you see it happening.",
    tools: [
      { name: "The Pause Practice", steps: ["Train yourself to insert a micro-pause before responding", "In conversations: take one breath before speaking", "For purchases: implement a 24-hour rule (wait a day before buying non-essentials)", "For decisions: ask 'What would my Defense Attorney say?' (CBT technique)", "Physical anchors help: press your feet into the floor, squeeze your hands, then respond"] },
      { name: "Behavioral Inhibition Training", steps: ["Notice the urge without acting on it (mindful awareness)", "Rate the urgency: 'How important is it that I do/say this RIGHT NOW?'", "Most impulses lose their intensity within 90 seconds", "Practice: when you feel the urge to interrupt, write down what you wanted to say instead"], hasTimer: true, timerSec: 90 }
    ]
  },
  {
    id: "procrastination",
    icon: "üêå", color: "#E8443A", cat: "motivation",
    title: "Procrastination",
    aka: "Playing with Fire / The Campfire That Becomes a Forest Fire",
    what: "Not laziness. Procrastination in ADHD is driven by emotional avoidance ‚Äî the task triggers uncomfortable feelings (boredom, anxiety, overwhelm, fear of failure) and your brain seeks escape. Some people even use procrastination as a motivation strategy, waiting for the adrenaline rush of a deadline.",
    feel: "Knowing exactly what you need to do and being unable to start. 'Chasing the task' all day. Deep shame afterward. A cycle of avoidance ‚Üí panic ‚Üí last-minute frenzy ‚Üí self-loathing. Using other tasks as 'plea bargaining' to avoid the real one.",
    tools: [
      { name: "The 10-Minute Rule", steps: ["Define the smallest possible first step (absurdly simple)", "Commit to just 10 honest minutes (600 seconds)", "The clock starts when you're actually in position to do the work", "After 10 minutes, reassess: keep going or stop guilt-free", "You didn't procrastinate. You made an informed decision.", "Most of the time, once you start, you'll keep going"], hasTimer: true, timerSec: 600 },
      { name: "Catch Your Procrastination Thoughts", steps: ["Notice what you're telling yourself: 'I'll do it tomorrow' / 'I need to be in the mood' / 'I'll do this other thing first'", "These automatic thoughts seem reasonable but are self-defeating", "Ask: Am I magnifying the negative and minimizing my ability?", "Reframe: 'I don't have to be in the mood. I just need to do the first step.'", "Common procrastination lies: 'I work best under pressure' (you don't ‚Äî you just rely on panic)"] },
      { name: "Discomfort Acceptance + Scaling", steps: ["Rate your discomfort 0-100. Most task-avoidance sits at 20-40, not 90", "Reminder: you CAN feel uncomfortable and still do the thing", "You don't need to be 100% energized. You need 51% ‚Äî just enough 'swing votes'", "Accept that the task involves some 'Ugh' ‚Äî that's normal, even for neurotypicals", "Focus on the feeling AFTER completion, not the feeling of starting"] }
    ]
  },
  {
    id: "shame",
    icon: "üòî", color: "#8E6FBF", cat: "emotion",
    title: "Shame & Self-Loathing",
    aka: "The Ghosts in the House / The Shame Hoarder",
    what: "Years of ADHD-related failures, misunderstandings, and 'you're not trying hard enough' messages create deep shame. Dr. Rosier describes shame as 'ghosts haunting your house' whispering lies like 'Why did you ruin everything?' The CBT Toolkit calls these 'invisible fences' that shock you into avoidance.",
    feel: "Persistent feeling of not being good enough. Wearing a 'mask' to hide the real you. Believing your mistakes define you. Using shame as motivation (which doesn't work). Comparing yourself to an idealized version of everyone else's best qualities.",
    tools: [
      { name: "The House-Yard-Fence (Boundaries with Yourself)", steps: ["Your internal self is a house ‚Äî only you live there", "Identify the 'ghosts' (shame messages) haunting it", "Respectfully ask them to leave. They'll come back. Ask again.", "Replace shame items with what you actually value", "Start small: one boundary, one emotional cleanup at a time"] },
      { name: "The Defense Attorney (CBT)", steps: ["Your shame thoughts are the Prosecutor's case against you", "Your Defense Attorney gets to respond with evidence too", "Ask: 'If my friend with ADHD told me this happened to them, would I call them a failure?'", "'Is there another way to see this that doesn't end with me being a terrible person?'", "Write the Prosecutor's argument and the Defense Attorney's response side by side ‚Äî seeing both makes the distortion obvious"] },
      { name: "Labeling vs. Behavioral Explanations", steps: ["Instead of 'I procrastinated because I'm lazy' (label)", "Try 'I procrastinated because the task felt overwhelming and I escaped to the computer' (behavioral)", "Labels feel permanent. Behaviors can be changed.", "This isn't letting yourself off the hook ‚Äî it's being accurate so you can actually fix it"] }
    ]
  },
  {
    id: "rejection-sensitivity",
    icon: "üíî", color: "#C06080", cat: "social",
    title: "Rejection Sensitive Dysphoria (RSD)",
    aka: "The Invisible Fence / The Paper-Thin Skin",
    what: "An intense emotional response to perceived rejection, criticism, or failure. A store clerk's flippant comment can ruin your day. It's not oversensitivity ‚Äî it's your emotional regulation system failing to buffer normal social friction. RSD makes boundary-setting terrifying because you fear rejection.",
    feel: "Devastation from mild criticism. Reading rejection into neutral interactions. Avoiding situations where you might fail or be judged. People-pleasing to prevent rejection. Physical pain from social slights.",
    tools: [
      { name: "Recognize the RSD Response", steps: ["When you feel sudden, intense emotional pain from a social interaction, pause", "Ask: 'Is this a Level 4/5 emotional response to a Level 1/2 situation?'", "Name it: 'This is my RSD activating, not reality'", "The feeling is real. The interpretation may not be.", "Give yourself 24 hours before taking action on the feeling"] },
      { name: "Perspective Taking (Defense Attorney)", steps: ["What evidence do I actually have that this person is rejecting me?", "Is there another explanation for their behavior?", "What would I tell a friend in this situation?", "In the grand scheme, how significant is this? Will it matter next week?", "Consider: most people are thinking about themselves, not judging you"] }
    ]
  },
  {
    id: "task-initiation",
    icon: "üöÄ", color: "#4D96FF", cat: "motivation",
    title: "Task Initiation Failure",
    aka: "The Invisible Wall / Stuck on the Launchpad",
    what: "Knowing what to do but being unable to start. The executive function of task initiation requires generating enough emotion/motivation to overcome inertia ‚Äî and ADHD brains have less dopamine available in the reward networks. The gap between 'not doing' and 'doing' is small but feels enormous.",
    feel: "Staring at the task, frozen. Knowing exactly what needs to happen but feeling paralyzed. Performing the start-sequence in your head but not in reality. The 'Ugh' feeling when facing a task.",
    tools: [
      { name: "Smallest Step of Behavioral Engagement", steps: ["Make the first step SO absurdly small it's ridiculous not to do it", "Not 'write the report' but 'open the document'", "Not 'go to the gym' but 'put on workout shoes'", "Not 'make the phone call' but 'find the person in my contacts'", "You're no longer procrastinating once you take this step", "If you're still stuck, break THAT step into even smaller steps"] },
      { name: "New Behavioral Scripts", steps: ["Identify your old script (e.g., come home ‚Üí couch ‚Üí TV ‚Üí guilt)", "Write a new script step by step (e.g., come home ‚Üí walk past couch ‚Üí go to computer ‚Üí open job site ‚Üí search for 15 min)", "Rehearse the new script mentally before the moment arrives", "Use If-Then plans for the choice points where old habits pull you away", "The old script isn't 'bad' ‚Äî it's just not serving your goals"] },
      { name: "Manufacturing 'Enough' Motivation", steps: ["You don't need to feel excited about the task ‚Äî you need 51%", "Lower the task's demands to match your current energy (limbo: 'how low can you go?')", "Say the first step OUT LOUD ‚Äî this gets you out of your head", "Make a verbal commitment to someone else for accountability", "Remember: action often precedes motivation, not the other way around"] }
    ]
  },
  {
    id: "overwhelm",
    icon: "üåÄ", color: "#E8443A", cat: "emotion",
    title: "Overwhelm & Paralysis",
    aka: "The Fire Hose / Too Many Tabs Open",
    what: "When too many demands collide with poor executive functioning, the system overloads. The ADHD brain can't prioritize, sequence, or filter effectively when flooded. The result is shutdown ‚Äî doing nothing at all despite having everything to do.",
    feel: "Paralysis. Knowing there's too much to do and doing none of it. Crying from the sheer volume. Shutting down and retreating to Blue Quadrant activities. Physical heaviness.",
    tools: [
      { name: "Brain Dump ‚Üí Triage", steps: ["Write down EVERYTHING in your head. Don't organize, just dump.", "Now circle only 3 things that matter most TODAY", "Put everything else away ‚Äî it will still be there tomorrow", "Define the first behavioral step for just ONE of the three", "You don't need to solve everything. You need to do one thing."] },
      { name: "The All-or-Nothing Antidote", steps: ["Catch the thought: 'If I can't do it all, why do anything?'", "This is all-or-nothing thinking ‚Äî a common distortion", "Reframe: 'Doing one thing is infinitely better than doing zero things'", "Any progress counts. Partial completion is not failure.", "Remember: you're comparing yourself to an imaginary standard"] },
      { name: "Body-First Reset", steps: ["When your mind is paralyzed, start with the body", "Stand up. Drink water. Splash cold water on your face.", "Take 5 slow breaths, focusing on the exhale", "Move: walk around the block, stretch, do 10 jumping jacks", "Then come back and pick ONE task. Just one."] }
    ]
  },
  {
    id: "cognitive-distortions",
    icon: "üëπ", color: "#E8443A", cat: "thinking",
    title: "Cognitive Distortions",
    aka: "The Monsters We Create / Thinking Errors",
    what: "Both books describe how ADHD's emotional dysregulation and executive dysfunction combine to create 'monsters' ‚Äî distorted thought patterns that feel absolutely real and convincing. These aren't delusions; they're rash conclusions drawn without full evidence that your brain treats as facts.",
    feel: "Catastrophizing small problems. 'Should' statements that set impossible standards. All-or-nothing thinking. Mind-reading what others think of you. Magnifying negatives, minimizing positives.",
    tools: [
      { name: "Identify Your Thinking Errors", steps: ["Magnification/Minimization ‚Äî making bad things bigger, good things smaller", "All-or-Nothing ‚Äî 'If it's not perfect, it's a total failure'", "Comparative Thinking ‚Äî measuring yourself against others' best qualities", "Emotional Reasoning ‚Äî 'I feel like an idiot, therefore I am one'", "Should Statements ‚Äî 'I should be able to do this without help'", "Fortune Telling ‚Äî 'I know this will end badly'", "Labeling ‚Äî 'I'm lazy' instead of 'I avoided a task because it felt overwhelming'"] },
      { name: "Consult Your Defense Attorney", steps: ["Write down the Prosecutor's case (your negative thought)", "Now write the Defense Attorney's response with actual evidence", "Questions to ask: Would I hold a friend to this standard?", "Is there another way to see this? What evidence am I ignoring?", "How significant is this really? Will it matter in a week?", "What's the worst case? Can I handle that? (Usually yes.)"] },
      { name: "Monster Spray (Dr. Rosier)", steps: ["For anxiety monsters: identify them, name them, and create a 'spray' (calming ritual)", "The ritual can be breathing exercises, grounding techniques, or a physical anchor", "The key insight: you can't kill the monsters, but you can keep them away", "When they come back (they will), spray again. Consistency is the tool."] }
    ]
  },
  {
    id: "energy-depletion",
    icon: "üîã", color: "#F5A623", cat: "executive",
    title: "Energy Depletion",
    aka: "The Dying Battery / Running on Fumes",
    what: "Everyone has limited energy, but ADHD batteries drain faster from activities others find easy. Emails, errands, and basic adulting can consume 50% of your daily battery while costing neurotypicals only 5%. If you don't manage your energy, the battery dies and you crash.",
    feel: "Exhaustion from 'easy' tasks. Crashing hard after social events or work. Needing far more recovery time than others. Feeling depleted by tasks that 'shouldn't' be tiring.",
    tools: [
      { name: "Battery Awareness Practice", steps: ["Throughout the day, check in: 'What's my battery percentage right now?'", "Track what charges you (Green activities) and what drains you", "Before adding a task to your day, ask: 'Can my battery handle this?'", "Schedule recharging activities BETWEEN draining ones ‚Äî not just at the end of the day"] },
      { name: "Energy Choreography (CBT Approach)", steps: ["Sequence tasks intentionally: hard task ‚Üí easy task ‚Üí break ‚Üí moderate task", "Follow a mentally draining task with administrative or physical tasks", "Protect time for meals, sleep, and movement ‚Äî these aren't luxury, they're battery maintenance", "Pair unpleasant tasks with pleasant activities: fold laundry while watching TV, exercise with music", "Remember: managing ADHD is an endurance sport. Find your rest on the field."] }
    ]
  },
  {
    id: "poor-boundaries",
    icon: "üè†", color: "#6BCB77", cat: "social",
    title: "Poor Boundaries",
    aka: "The Doormat / People Pleasing",
    what: "ADHD symptoms (impulsivity, RSD, poor self-regulation) make it hard to set and enforce limits. Many people with ADHD didn't learn boundaries growing up. People-pleasing becomes a coping strategy to avoid rejection. Combined with RSD, saying 'no' feels terrifying.",
    feel: "Saying yes when you mean no. Letting others walk over your limits. Overcommitting and then drowning. Difficulty knowing where you end and others begin. Resentment building beneath a 'nice' exterior.",
    tools: [
      { name: "House-Yard-Fence Framework", steps: ["House = your internal self (psyche, values, identity). Only you live here.", "Yard = your personal space (time, energy, social interactions). Invited guests only.", "Fence = the boundary between you and the world. You control the gate.", "Start with ONE physical boundary (bedtime, budget rule, screen-free zone)", "When it becomes habit, add the next one. Don't overhaul everything at once."] },
      { name: "Emotional Boundary Cleanup", steps: ["Identify the 'ghosts' in your house ‚Äî shame, envy, anxiety that don't belong to you", "Name them, then respectfully ask them to leave", "When they come back (they will), ask again. This is persistence, not failure.", "Stop collecting other people's emotional garbage ‚Äî you have enough of your own", "Set limits on gossip, blame-shifting, and emotional caretaking of others"] }
    ]
  },
  {
    id: "transition-difficulty",
    icon: "üîÄ", color: "#A78BFA", cat: "executive",
    title: "Transition Difficulty",
    aka: "The Stuck Switch / Can't Shift Gears",
    what: "Switching from one task, activity, or mindset to another requires executive functions that ADHD impairs. Getting out of bed, leaving the house, switching from work mode to home mode, transitioning between tasks ‚Äî each one costs extra effort. This isn't laziness; it's a genuine cognitive shifting deficit.",
    feel: "Getting stuck on one activity for too long. Difficulty shifting from leisure to work mode. Stress during daily transitions (morning routine, commute). Feeling 'locked in' to whatever you're currently doing.",
    tools: [
      { name: "Transition Rituals", steps: ["Create a consistent small ritual for common transitions", "Morning: same sequence every day (alarm ‚Üí feet on floor ‚Üí bathroom ‚Üí coffee)", "Work to home: change clothes, take a 5-minute walk, or listen to a specific playlist", "Between tasks: stand up, stretch, take 3 breaths, look at your to-do list, then start the next thing"], hasTimer: true, timerSec: 300 },
      { name: "Leaving Breadcrumbs + Pre-Loading", steps: ["Before stopping a task, write down your next step for when you return", "Before a transition, mentally rehearse the next activity: 'When I get home, I will walk to the computer first'", "Use timers with 5-minute warnings before transitions", "External cues (alarms, visual schedules, sticky notes on doors) reduce the cognitive cost of switching"] }
    ]
  }
];

const patterns = [
  {
    icon: "üèéÔ∏è", color: "#E8443A", title: "The Need-for-Speed Pattern",
    aka: "Red Quadrant Addiction",
    what: "You create tension and crisis to feel alive and productive. Packed schedule, always rushing, adrenaline-fueled. You believe more-is-better and tie self-worth to accomplishments. Your body lives in constant stress response.",
    strategies: [
      "Challenge the false belief: 'I'm only worthy when I accomplish things'",
      "Morning: 15 minutes of breathing and intentional planning (include Yellow AND Blue tasks)",
      "Midday alarm for system check: posture, hydration, jaw tension, basic needs",
      "Evening: 10 minutes appreciating what you DID accomplish ‚Äî no shaming for what you didn't",
      "Ask: 'Am I doing important things, or just lots of things?'"
    ]
  },
  {
    icon: "üî•", color: "#F5A623", title: "The Playing-with-Fire Pattern",
    aka: "Yellow ‚Üí Red Escalation",
    what: "You let boring Yellow tasks sit until they become Red emergencies. The small campfire becomes a forest fire. Unlike Need-for-Speed, you don't enjoy the Red ‚Äî you feel shame and sadness after the scramble. You also deny yourself Green time because you feel you haven't earned it.",
    strategies: [
      "Challenge: 'I work well under pressure' ‚Äî you're using anxiety as fuel, and it's exhausting",
      "Morning: List 3-5 Yellow tasks. Break the ugliest one into small how-to steps",
      "Commit to 20 minutes on a Yellow task. If no flow after 20 min, switch",
      "Midday: check which Yellow tasks are creeping toward Red. Address them NOW",
      "Evening: Appreciate progress. Allow yourself Green time ‚Äî you've earned it"
    ]
  },
  {
    icon: "üîÅ", color: "#4D96FF", title: "Red, Blue, and Back Again",
    aka: "All-or-Nothing Energy",
    what: "Frantic Red productivity for days/weeks, then collapse into Blue for days/weeks. Two speeds: on and off. No middle ground. You miss the sweet moments of life because you're either sprinting or comatose. Your loved ones find the flip-flopping confusing and draining.",
    strategies: [
      "Challenge: 'I can't slow down, there's too much to do' ‚Äî balance is not optional, it's survival",
      "Morning: include items from ALL four quadrants in your daily plan",
      "Midday: Have you done anything besides Red and Yellow? Add Green or Blue NOW",
      "Evening: End work at a set time. Schedule Green activities with important people",
      "Remember: your all-or-nothing pattern affects your relationships too"
    ]
  },
  {
    icon: "üõãÔ∏è", color: "#4ECDC4", title: "The Nothin'-but-Blue Pattern",
    aka: "The Avoidance Cocoon",
    what: "You steer clear of anything uncomfortable and shelter in Blue activities. Not procrastination (you have no intention of doing the hard thing). Life feels too complicated, so you stay in your comfortable cocoon of entertainment and busywork. Often rooted in perfectionism: 'If I can't do it perfectly, I won't risk it.'",
    strategies: [
      "Challenge three false beliefs: (1) any task will drain all my energy, (2) if it's not perfect, don't try, (3) if I fail, people won't love me",
      "Face the Blue: identify which Blue activity is your trap. Try 24 hours without it",
      "Set a goal of completing just 3 Yellow tasks today",
      "Yellow-Blue game: 30 min work, 10 min Blue break (with a timer!)",
      "Reward 3 completed Yellow tasks with a longer Blue session or, better yet, a Green activity"
    ]
  }
];

const cbtTools = [
  {
    icon: "üìã", color: "#4D96FF", title: "The Daily Planning System",
    aka: "Comprehensive To-Do ‚Üí Daily To-Do ‚Üí Daily Planner",
    what: "The foundation of the CBT approach. Three interconnected tools that externalize your executive functioning: (1) A master 'brain dump' list of everything, (2) A daily list of 3-5 specific tasks pulled from the master, and (3) A time-blocked planner showing when each task happens.",
    tools: [
      { name: "How to Set Up", steps: ["Keep ONE comprehensive to-do list (paper or digital) ‚Äî dump everything here", "Each morning, spend 10 minutes (600 seconds!) choosing today's 3-5 priorities", "Define each task in behavioral terms: what exactly will you DO?", "Block time in your planner: start time, end time, specific task", "Include self-care tasks (meals, exercise, breaks) as real appointments", "Review the planner early and often ‚Äî it's your external brain"], hasTimer: true, timerSec: 600 }
    ]
  },
  {
    icon: "üß±", color: "#6BCB77", title: "Breaking Down Tasks",
    aka: "The Behavioral Recipe",
    what: "Large, vague tasks paralyze the ADHD brain. The solution: break every task into a 'behavioral recipe' ‚Äî steps so specific that someone else could follow them. Work backwards from the deadline. The goal is to turn 'write the report' into a series of absurdly simple actions.",
    tools: [
      { name: "Step-by-Step Process", steps: ["Identify the task and its deadline", "Write the end point: what does 'done' look like?", "Work backwards: what's the step before the last step? And before that?", "Make each step specific and behavioral (not 'research' but 'search Google for X and read 3 articles')", "Budget the steps across days in your planner", "Define today's smallest first step ‚Äî make it absurdly simple", "If you're still stuck, break THAT step into smaller steps"] }
    ]
  },
  {
    icon: "‚öñÔ∏è", color: "#8E6FBF", title: "The Defense Attorney",
    aka: "Cognitive Restructuring for ADHD",
    what: "Your negative thoughts are the Prosecutor making a one-sided case against you. A fair trial means your Defense Attorney gets to respond. This isn't positive thinking ‚Äî it's balanced thinking. You're not dismissing your feelings; you're cross-examining them.",
    tools: [
      { name: "How to Use", steps: ["Catch the automatic thought: 'What am I thinking right now?'", "Write down the Prosecutor's case (your negative interpretation)", "Identify the thinking error(s): magnification? all-or-nothing? labeling?", "Now: what would your Defense Attorney say?", "Key questions: Would I say this to a friend? What evidence am I ignoring? Will this matter in a week?", "Write both sides down ‚Äî thoughts lose power when they leave your head", "Choose an action based on the balanced view"] }
    ]
  },
  {
    icon: "üé≠", color: "#F5A623", title: "The Method Acting Approach",
    aka: "Act 'As If' / Opposite Action",
    what: "When you're stuck in an emotion that's blocking action, act opposite to the emotion. Smile when angry. Say 'Let's DO this!' when you feel paralyzed. It's not about being fake ‚Äî it's about breaking the emotional-behavioral loop that keeps you stuck. Combined with a defined first step, it's surprisingly effective.",
    tools: [
      { name: "How to Practice", steps: ["Identify the blocking emotion (dread, boredom, anxiety, fatigue)", "Choose an opposite action: clap hands, stand up, say something encouraging aloud", "Define your smallest behavioral step", "Combine: opposite action + first step = momentum", "This gets easier with practice ‚Äî you're retraining your brain's associations"] }
    ]
  },
  {
    icon: "üèÜ", color: "#FFD93D", title: "Reward Systems",
    aka: "The Premack Principle / Earning Your Fun",
    what: "Use the psychological principle that you increase the likelihood of doing a less-desired task by following it with a highly desired activity. Transform your escape behaviors from procrastination enablers into positive rewards for task completion.",
    tools: [
      { name: "How to Set Up", steps: ["Identify rewards that genuinely motivate you", "Link them to specific task completions: 'After 30 min of studying ‚Üí 1 song download'", "Make the reward something you ONLY get for completing that task", "Transform escape behaviors: instead of checking Instagram to avoid work, earn Instagram time by completing work first", "Notice the positive feeling of getting things done ‚Äî that's intrinsic reward building"], hasTimer: true, timerSec: 1800 }
    ]
  },
  {
    icon: "ü§ñ", color: "#4ECDC4", title: "Outsourcing Coping Skills",
    aka: "Let Technology and People Help",
    what: "You don't have to do everything with willpower. Automate what you can, hire help where possible, and use technology as your external executive function system. This isn't cheating ‚Äî it's strategic.",
    tools: [
      { name: "Outsourcing Ideas", steps: ["Set up automatic bill payments ‚Äî remove the task entirely", "Use automatic reminders for everything: appointments, medication, deadlines", "Hire or barter for tasks you consistently struggle with (cleaning, taxes, organizing)", "Use good tools: a planner that works for YOU, apps that serve your brain", "Beware 'fool's gold' ‚Äî buying productivity tools without using them", "The best tool is the one you'll actually use consistently"] }
    ]
  }
];

// ============ FAVORITES SYSTEM ============
function getFavorites() {
  try { return JSON.parse(localStorage.getItem('adhd-favorites') || '[]'); } catch { return []; }
}
function saveFavorites(favs) { localStorage.setItem('adhd-favorites', JSON.stringify(favs)); }
function toggleFavorite(id) {
  let favs = getFavorites();
  const idx = favs.indexOf(id);
  if (idx > -1) { favs.splice(idx, 1); } else { favs.push(id); }
  saveFavorites(favs);
  document.querySelectorAll(`.fav-btn[data-fav-id="${id}"]`).forEach(btn => {
    btn.classList.toggle('favorited', favs.includes(id));
    btn.textContent = favs.includes(id) ? '‚≠ê' : '‚òÜ';
  });
  renderFavorites();
}

// ============ TIMER SYSTEM ============
let activeTimers = {};
function startTimer(btnEl, seconds) {
  const id = btnEl.dataset.timerId;
  if (activeTimers[id]) { clearInterval(activeTimers[id]); delete activeTimers[id]; btnEl.classList.remove('running'); btnEl.querySelector('.timer-display').textContent = formatTime(seconds); return; }
  let remaining = seconds;
  btnEl.classList.add('running');
  const display = btnEl.querySelector('.timer-display');
  display.textContent = formatTime(remaining);
  activeTimers[id] = setInterval(() => {
    remaining--;
    display.textContent = formatTime(remaining);
    if (remaining <= 0) {
      clearInterval(activeTimers[id]); delete activeTimers[id]; btnEl.classList.remove('running');
      display.textContent = "Done!";
      try { new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdW+HjYyGgHd0eH2DhomIhX95dXZ7gIaJiYZ/eHR2e4CGiomGf3h0dnt/hoqJhn94dHZ7f4aKiYZ/eHR2e3+GiomGf3h0dQ==").play(); } catch {}
      setTimeout(() => { display.textContent = formatTime(seconds); }, 3000);
    }
  }, 1000);
}
function formatTime(s) { const m = Math.floor(s / 60); const sec = s % 60; return `${m}:${sec.toString().padStart(2, '0')}`; }
let timerCounter = 0;

// ============ RENDER FUNCTIONS ============
function renderTraitCard(t) {
  const favs = getFavorites();
  const toolsHTML = t.tools.map((tool, i) => {
    const favId = `${t.id}-tool-${i}`;
    const isFav = favs.includes(favId);
    const timerId = `timer-${timerCounter++}`;
    const timerHTML = tool.hasTimer ? `<div class="inline-timer" data-timer-id="${timerId}" onclick="startTimer(this, ${tool.timerSec})">‚è± <span class="timer-display">${formatTime(tool.timerSec)}</span> ‚Äî tap to start</div>` : '';
    return `
    <div class="tool-card">
      <button class="fav-btn ${isFav?'favorited':''}" data-fav-id="${favId}" onclick="event.stopPropagation();toggleFavorite('${favId}')">${isFav?'‚≠ê':'‚òÜ'}</button>
      <h4>üîß ${tool.name}</h4>
      <ol class="steps">${tool.steps.map(s => `<li>${s}</li>`).join('')}</ol>
      ${timerHTML}
    </div>
  `}).join('');

  return `
    <div class="trait-card" data-cat="${t.cat}" data-search="${(t.title + ' ' + t.aka + ' ' + t.what + ' ' + t.feel + ' ' + t.tools.map(x=>x.name+' '+x.steps.join(' ')).join(' ')).toLowerCase()}">
      <div class="trait-header" onclick="this.parentElement.classList.toggle('open')">
        <div class="trait-icon" style="background:${t.color}22;color:${t.color}">${t.icon}</div>
        <div class="trait-title-group">
          <h3 style="color:${t.color}">${t.title}</h3>
          <div class="aka">${t.aka}</div>
        </div>
        <div class="expand-arrow">‚ñº</div>
      </div>
      <div class="trait-body">
        <div class="trait-content">
          <div class="trait-section">
            <div class="trait-section-label label-what">What It Is</div>
            <p>${t.what}</p>
          </div>
          <div class="trait-section">
            <div class="trait-section-label label-feel">How It Feels</div>
            <p>${t.feel}</p>
          </div>
          <div class="trait-section">
            <div class="trait-section-label label-tool">Tools to Manage It</div>
            ${toolsHTML}
          </div>
        </div>
      </div>
    </div>
  `;
}

function renderPatternCard(p) {
  return `
    <div class="trait-card">
      <div class="trait-header" onclick="this.parentElement.classList.toggle('open')">
        <div class="trait-icon" style="background:${p.color}22;color:${p.color}">${p.icon}</div>
        <div class="trait-title-group">
          <h3 style="color:${p.color}">${p.title}</h3>
          <div class="aka">${p.aka}</div>
        </div>
        <div class="expand-arrow">‚ñº</div>
      </div>
      <div class="trait-body">
        <div class="trait-content">
          <div class="trait-section">
            <div class="trait-section-label label-what">The Pattern</div>
            <p>${p.what}</p>
          </div>
          <div class="trait-section">
            <div class="trait-section-label label-tool">Strategies to Break It</div>
            <ul>${p.strategies.map(s => `<li>${s}</li>`).join('')}</ul>
          </div>
        </div>
      </div>
    </div>
  `;
}

function renderCBTCard(c) {
  const favs = getFavorites();
  const toolsHTML = c.tools.map((tool, i) => {
    const favId = `cbt-${c.title.replace(/\s+/g,'-').toLowerCase()}-tool-${i}`;
    const isFav = favs.includes(favId);
    const timerId = `timer-${timerCounter++}`;
    const timerHTML = tool.hasTimer ? `<div class="inline-timer" data-timer-id="${timerId}" onclick="startTimer(this, ${tool.timerSec})">‚è± <span class="timer-display">${formatTime(tool.timerSec)}</span> ‚Äî tap to start</div>` : '';
    return `
    <div class="tool-card">
      <button class="fav-btn ${isFav?'favorited':''}" data-fav-id="${favId}" onclick="event.stopPropagation();toggleFavorite('${favId}')">${isFav?'‚≠ê':'‚òÜ'}</button>
      <h4>üîß ${tool.name}</h4>
      <ol class="steps">${tool.steps.map(s => `<li>${s}</li>`).join('')}</ol>
      ${timerHTML}
    </div>
  `}).join('');

  return `
    <div class="trait-card">
      <div class="trait-header" onclick="this.parentElement.classList.toggle('open')">
        <div class="trait-icon" style="background:${c.color}22;color:${c.color}">${c.icon}</div>
        <div class="trait-title-group">
          <h3 style="color:${c.color}">${c.title}</h3>
          <div class="aka">${c.aka}</div>
        </div>
        <div class="expand-arrow">‚ñº</div>
      </div>
      <div class="trait-body">
        <div class="trait-content">
          <div class="trait-section">
            <div class="trait-section-label label-what">What It Is</div>
            <p>${c.what}</p>
          </div>
          <div class="trait-section">
            <div class="trait-section-label label-how">How to Use It</div>
            ${toolsHTML}
          </div>
        </div>
      </div>
    </div>
  `;
}

// ============ RENDER FAVORITES ============
function renderFavorites() {
  const favs = getFavorites();
  const container = document.getElementById('favsContainer');
  if (!favs.length) {
    container.innerHTML = `<div class="fav-empty"><div class="fav-empty-emoji">‚≠ê</div><div class="fav-empty-text">No tools saved yet. Browse the Traits & Tools or CBT Toolkit tabs and tap the ‚òÜ on any tool card to save it here.</div></div>`;
    return;
  }
  let html = '<div class="trait-grid">';
  // Find matching tools
  favs.forEach(favId => {
    // Check traits
    traits.forEach(t => {
      t.tools.forEach((tool, i) => {
        if (`${t.id}-tool-${i}` === favId) {
          const timerId = `timer-${timerCounter++}`;
          const timerHTML = tool.hasTimer ? `<div class="inline-timer" data-timer-id="${timerId}" onclick="startTimer(this, ${tool.timerSec})">‚è± <span class="timer-display">${formatTime(tool.timerSec)}</span> ‚Äî tap to start</div>` : '';
          html += `<div class="tool-card" style="border-left:3px solid ${t.color}">
            <button class="fav-btn favorited" data-fav-id="${favId}" onclick="toggleFavorite('${favId}')">‚≠ê</button>
            <h4>${t.icon} ${tool.name}</h4>
            <div style="font-size:0.78rem;color:var(--text-muted);margin-bottom:0.5rem">from ${t.title}</div>
            <ol class="steps">${tool.steps.map(s => `<li>${s}</li>`).join('')}</ol>
            ${timerHTML}
          </div>`;
        }
      });
    });
    // Check CBT tools
    cbtTools.forEach(c => {
      c.tools.forEach((tool, i) => {
        const cbtId = `cbt-${c.title.replace(/\s+/g,'-').toLowerCase()}-tool-${i}`;
        if (cbtId === favId) {
          const timerId = `timer-${timerCounter++}`;
          const timerHTML = tool.hasTimer ? `<div class="inline-timer" data-timer-id="${timerId}" onclick="startTimer(this, ${tool.timerSec})">‚è± <span class="timer-display">${formatTime(tool.timerSec)}</span> ‚Äî tap to start</div>` : '';
          html += `<div class="tool-card" style="border-left:3px solid ${c.color}">
            <button class="fav-btn favorited" data-fav-id="${favId}" onclick="toggleFavorite('${favId}')">‚≠ê</button>
            <h4>${c.icon} ${tool.name}</h4>
            <div style="font-size:0.78rem;color:var(--text-muted);margin-bottom:0.5rem">from ${c.title}</div>
            <ol class="steps">${tool.steps.map(s => `<li>${s}</li>`).join('')}</ol>
            ${timerHTML}
          </div>`;
        }
      });
    });
  });
  html += '</div>';
  container.innerHTML = html;
}

// ============ INIT ============
document.getElementById('traitGrid').innerHTML = traits.map(renderTraitCard).join('');
document.getElementById('patternGrid').innerHTML = patterns.map(renderPatternCard).join('');
document.getElementById('cbtGrid').innerHTML = cbtTools.map(renderCBTCard).join('');
renderFavorites();

// ============ NAV ============
function switchToPage(pageName) {
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  const btn = document.querySelector(`.nav-btn[data-page="${pageName}"]`);
  if (btn) btn.classList.add('active');
  const page = document.getElementById('page-' + pageName);
  if (page) page.classList.add('active');
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

document.querySelectorAll('.nav-btn').forEach(btn => {
  btn.addEventListener('click', () => switchToPage(btn.dataset.page));
});

// ============ SEARCH ============
function filterTraits() {
  const query = document.getElementById('traitSearch').value.toLowerCase();
  document.querySelectorAll('#traitGrid .trait-card').forEach(card => {
    const match = card.dataset.search.includes(query);
    card.style.display = match ? '' : 'none';
  });
}

// ============ CATEGORY FILTER ============
document.querySelectorAll('.filter-chip').forEach(chip => {
  chip.addEventListener('click', () => {
    document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
    chip.classList.add('active');
    const cat = chip.dataset.cat;
    document.querySelectorAll('#traitGrid .trait-card').forEach(card => {
      card.style.display = (cat === 'all' || card.dataset.cat === cat) ? '' : 'none';
    });
  });
});

// ============ SOS SYSTEM ============
function openSOS() {
  document.getElementById('sosOverlay').classList.add('open');
  document.getElementById('sosStep1').style.display = 'block';
  document.querySelectorAll('.sos-action').forEach(a => a.classList.remove('visible'));
}
function closeSOS() { document.getElementById('sosOverlay').classList.remove('open'); }
function showSOSAction(type) {
  document.getElementById('sosStep1').style.display = 'none';
  document.getElementById('sos-' + type).classList.add('visible');
}
function sosGoBack() {
  document.querySelectorAll('.sos-action').forEach(a => a.classList.remove('visible'));
  document.getElementById('sosStep1').style.display = 'block';
}

// ============ MY DAY PLANNER ============
function getTodayKey() { return 'myday-' + new Date().toISOString().slice(0, 10); }
function getTasks() { try { return JSON.parse(localStorage.getItem(getTodayKey()) || '[]'); } catch { return []; } }
function saveTasks(tasks) { localStorage.setItem(getTodayKey(), JSON.stringify(tasks)); }

function addTask() {
  const input = document.getElementById('braindumpInput');
  const text = input.value.trim();
  if (!text) return;
  const tasks = getTasks();
  tasks.push({ id: Date.now(), text, color: null, done: false });
  saveTasks(tasks);
  input.value = '';
  renderTasks();
  input.focus();
}

function toggleTaskDone(id) {
  const tasks = getTasks();
  const task = tasks.find(t => t.id === id);
  if (task) { task.done = !task.done; saveTasks(tasks); renderTasks(); }
}

function setTaskColor(id, color) {
  const tasks = getTasks();
  const task = tasks.find(t => t.id === id);
  if (task) { task.color = task.color === color ? null : color; saveTasks(tasks); renderTasks(); }
}

function deleteTask(id) {
  let tasks = getTasks();
  tasks = tasks.filter(t => t.id !== id);
  saveTasks(tasks);
  renderTasks();
}

function renderTasks() {
  const tasks = getTasks();
  const container = document.getElementById('taskList');
  if (!tasks.length) {
    container.innerHTML = '<div class="empty-state"><div class="empty-state-emoji">üß†</div><div class="empty-state-text">Your brain dump is empty. Add some tasks above ‚Äî don\'t think, just type.</div></div>';
  } else {
    container.innerHTML = tasks.map(t => `
      <div class="task-item ${t.done?'completed':''}" data-color="${t.color||''}">
        <button class="task-done-btn" onclick="toggleTaskDone(${t.id})">${t.done?'‚úì':''}</button>
        <span class="task-text">${t.text}</span>
        <div class="task-color-btns">
          <div class="task-color-btn tc-red ${t.color==='red'?'selected':''}" title="Red ‚Äî urgent/stressful" onclick="setTaskColor(${t.id},'red')"></div>
          <div class="task-color-btn tc-yellow ${t.color==='yellow'?'selected':''}" title="Yellow ‚Äî boring but needed" onclick="setTaskColor(${t.id},'yellow')"></div>
          <div class="task-color-btn tc-blue ${t.color==='blue'?'selected':''}" title="Blue ‚Äî chill/recharge" onclick="setTaskColor(${t.id},'blue')"></div>
          <div class="task-color-btn tc-green ${t.color==='green'?'selected':''}" title="Green ‚Äî fun & meaningful" onclick="setTaskColor(${t.id},'green')"></div>
        </div>
        <button class="task-delete" onclick="deleteTask(${t.id})">‚úï</button>
      </div>
    `).join('');
  }
  updateEnergyMeter(tasks);
  updateStats(tasks);
}

function updateEnergyMeter(tasks) {
  const coloredTasks = tasks.filter(t => t.color);
  const bar = document.getElementById('energyBar');
  const nudge = document.getElementById('energyNudge');
  if (!coloredTasks.length) {
    bar.innerHTML = '<div style="flex:1;display:flex;align-items:center;justify-content:center;font-size:0.78rem;color:var(--text-muted)">Color your tasks to see the energy balance</div>';
    nudge.textContent = '';
    nudge.className = 'energy-nudge';
    nudge.style.display = 'none';
    return;
  }
  const counts = { red: 0, yellow: 0, blue: 0, green: 0 };
  coloredTasks.forEach(t => { if (counts[t.color] !== undefined) counts[t.color]++; });
  const total = coloredTasks.length;
  bar.innerHTML = ['red','yellow','blue','green'].map(c => {
    const pct = (counts[c] / total) * 100;
    return pct > 0 ? `<div class="energy-segment seg-${c}" style="width:${pct}%">${counts[c]}</div>` : '';
  }).join('');

  // Generate nudge
  nudge.style.display = 'block';
  const redPct = counts.red / total;
  const yellowPct = counts.yellow / total;
  const greenPct = counts.green / total;
  const bluePct = counts.blue / total;
  const drainPct = redPct + yellowPct;

  if (counts.green === 0 && counts.blue === 0 && total > 1) {
    nudge.className = 'energy-nudge'; nudge.innerHTML = "‚ö†Ô∏è <strong>All drain, no recharge.</strong> Your battery will hit zero. Add at least one Green or Blue activity ‚Äî you need fuel, not just tasks.";
  } else if (redPct > 0.5) {
    nudge.className = 'energy-nudge'; nudge.innerHTML = "üî¥ <strong>Heavy Red day.</strong> That's a lot of adrenaline. Can any of these become Yellow by breaking them into smaller steps? Your body can't sustain this.";
  } else if (yellowPct > 0.6 && greenPct === 0) {
    nudge.className = 'energy-nudge'; nudge.innerHTML = "üü° <strong>Yellow marathon.</strong> Boring tasks are a slow drain ‚Äî schedule a Green reward between them or pair them with something pleasant (music, a drink, a podcast).";
  } else if (bluePct > 0.6) {
    nudge.className = 'energy-nudge'; nudge.innerHTML = "üîµ <strong>Lots of Blue.</strong> Ask yourself: is this recharging you or numbing you? Try swapping one Blue for a Green ‚Äî it recharges faster and you'll feel better after.";
  } else if (greenPct > 0 && drainPct > 0 && drainPct <= 0.7) {
    nudge.className = 'energy-nudge positive'; nudge.innerHTML = "‚úÖ <strong>Nice balance.</strong> You've got drain and recharge mixed in. This is sustainable. Remember to do the Green ‚Äî don't skip it because you feel you haven't earned it.";
  } else if (counts.green > 0) {
    nudge.className = 'energy-nudge positive'; nudge.innerHTML = "üü¢ <strong>Green on the board.</strong> Good. Make sure it actually happens ‚Äî it's the first thing that gets sacrificed when the day gets busy, and it shouldn't be.";
  } else {
    nudge.style.display = 'none';
  }
}

function updateStats(tasks) {
  document.getElementById('statTotal').textContent = tasks.length;
  document.getElementById('statDone').textContent = tasks.filter(t => t.done).length;
  // Streak
  let streak = 0;
  const today = new Date();
  for (let i = 0; i < 365; i++) {
    const d = new Date(today);
    d.setDate(d.getDate() - i);
    const key = 'myday-' + d.toISOString().slice(0, 10);
    const dayTasks = JSON.parse(localStorage.getItem(key) || '[]');
    if (dayTasks.some(t => t.done)) { streak++; } else if (i > 0) { break; }
  }
  document.getElementById('statStreak').textContent = streak;
}

function clearDay() {
  if (confirm('Start fresh? This will clear all of today\'s tasks.')) {
    localStorage.removeItem(getTodayKey());
    renderTasks();
  }
}

function carryForward() {
  const yesterday = new Date();
  yesterday.setDate(yesterday.getDate() - 1);
  const yesterdayKey = 'myday-' + yesterday.toISOString().slice(0, 10);
  const oldTasks = JSON.parse(localStorage.getItem(yesterdayKey) || '[]');
  const unfinished = oldTasks.filter(t => !t.done);
  if (!unfinished.length) { alert('No unfinished tasks from yesterday!'); return; }
  const current = getTasks();
  unfinished.forEach(t => { t.id = Date.now() + Math.random(); current.push(t); });
  saveTasks(current);
  renderTasks();
}

// Init My Day
renderTasks();

// ============ QUIZ ============
const quizQuestions = [
  {
    q: "When you have a boring task to do, what usually happens?",
    answers: [
      { text: "I wait until it's a crisis, then power through on adrenaline", scores: { speed: 2, fire: 1 } },
      { text: "I keep putting it off until it becomes an emergency I dread", scores: { fire: 2, blue: 1 } },
      { text: "I ignore it completely and do something fun instead", scores: { blue: 2 } },
      { text: "I alternate between frantic productivity and total shutdown", scores: { redblue: 2, speed: 1 } }
    ]
  },
  {
    q: "How would your closest person describe your energy?",
    answers: [
      { text: "Always on, always busy, never stops", scores: { speed: 2 } },
      { text: "Calm on the surface but quietly panicking about deadlines", scores: { fire: 2 } },
      { text: "Hard to get going, prefers comfort and routine", scores: { blue: 2 } },
      { text: "Unpredictable ‚Äî either sprinting or crashed on the couch", scores: { redblue: 2 } }
    ]
  },
  {
    q: "When do you feel most productive?",
    answers: [
      { text: "When I have a packed schedule and everything is urgent", scores: { speed: 2, redblue: 1 } },
      { text: "Right before a deadline, in full panic mode", scores: { fire: 2 } },
      { text: "Honestly? I rarely feel productive and that bothers me", scores: { blue: 2 } },
      { text: "In intense bursts, but then I crash hard for days", scores: { redblue: 2 } }
    ]
  },
  {
    q: "How do you feel about Green time (fun, meaningful activities)?",
    answers: [
      { text: "I don't have time for that ‚Äî too much to do", scores: { speed: 2 } },
      { text: "I feel like I haven't earned it, so I skip it", scores: { fire: 2, blue: 1 } },
      { text: "I do lots of Blue (Netflix, scrolling) but not much Green", scores: { blue: 2 } },
      { text: "Sometimes I binge on fun, then feel guilty and overwork", scores: { redblue: 2 } }
    ]
  },
  {
    q: "What's your relationship with rest?",
    answers: [
      { text: "Rest feels like failure. I should always be doing something", scores: { speed: 2 } },
      { text: "I rest too late ‚Äî only after I've burned out from the crisis", scores: { fire: 2 } },
      { text: "I rest a lot but it doesn't actually recharge me", scores: { blue: 2, fire: 1 } },
      { text: "I swing between zero rest and total collapse", scores: { redblue: 2 } }
    ]
  },
  {
    q: "When you look at your week, which feels most true?",
    answers: [
      { text: "Every day is packed. I thrive on the rush.", scores: { speed: 2 } },
      { text: "I spent most of the week avoiding one big thing", scores: { fire: 2 } },
      { text: "I didn't do much and I feel bad about it", scores: { blue: 2 } },
      { text: "Some days I was Superman, other days I couldn't get off the couch", scores: { redblue: 2 } }
    ]
  }
];

const patternResults = {
  speed: { icon: "üèéÔ∏è", color: "#E8443A", title: "The Need-for-Speed Pattern", desc: "You run on adrenaline and equate busyness with worth. Your engine is always revving, but you're burning out the transmission.", page: "patterns" },
  fire: { icon: "üî•", color: "#F5A623", title: "The Playing-with-Fire Pattern", desc: "You let small tasks smolder until they're on fire. The panic gets you moving, but the shame afterward is crushing ‚Äî and you never let yourself rest.", page: "patterns" },
  blue: { icon: "üõãÔ∏è", color: "#4ECDC4", title: "The Nothin'-but-Blue Pattern", desc: "You've retreated into your comfort cocoon. It's not laziness ‚Äî it's often perfectionism or fear underneath. The Blue feels safe but it's slowly numbing you.", page: "patterns" },
  redblue: { icon: "üîÅ", color: "#4D96FF", title: "Red, Blue, and Back Again", desc: "You only have two speeds: everything and nothing. The whiplash is exhausting ‚Äî for you and everyone around you. The middle gears exist; you just haven't found them yet.", page: "patterns" }
};

let quizStep = 0;
let quizScores = { speed: 0, fire: 0, blue: 0, redblue: 0 };

function renderQuiz() {
  const card = document.getElementById('quizCard');
  if (quizStep >= quizQuestions.length) { renderQuizResult(); return; }
  const q = quizQuestions[quizStep];
  const progressHTML = quizQuestions.map((_, i) => `<div class="quiz-dot ${i < quizStep ? 'filled' : ''}"></div>`).join('');
  card.innerHTML = `
    <div class="quiz-progress">${progressHTML}</div>
    <div class="quiz-question">${q.q}</div>
    <div class="quiz-answers">
      ${q.answers.map((a, i) => `<div class="quiz-answer" onclick="selectQuizAnswer(${i})">${a.text}</div>`).join('')}
    </div>
  `;
}

function selectQuizAnswer(idx) {
  const q = quizQuestions[quizStep];
  const scores = q.answers[idx].scores;
  Object.keys(scores).forEach(k => { quizScores[k] = (quizScores[k] || 0) + scores[k]; });
  quizStep++;
  renderQuiz();
}

function renderQuizResult() {
  const card = document.getElementById('quizCard');
  const winner = Object.entries(quizScores).sort((a,b) => b[1] - a[1])[0][0];
  const result = patternResults[winner];
  const pattern = patterns.find(p => p.title === result.title);
  const strategies = pattern ? pattern.strategies : [];
  card.innerHTML = `
    <div class="quiz-result">
      <div class="quiz-result-icon">${result.icon}</div>
      <h3 style="color:${result.color}">${result.title}</h3>
      <p>${result.desc}</p>
      <div class="quiz-result-strategies">
        <h4>Your targeted strategies:</h4>
        <ul>${strategies.map(s => `<li>${s}</li>`).join('')}</ul>
      </div>
      <button class="quiz-go-btn" onclick="switchToPage('patterns')">See all patterns ‚Üí</button>
      <br>
      <button class="quiz-restart" onclick="restartQuiz()">Retake quiz</button>
    </div>
  `;
}

function restartQuiz() {
  quizStep = 0;
  quizScores = { speed: 0, fire: 0, blue: 0, redblue: 0 };
  renderQuiz();
}

renderQuiz();

// ============ LADDER TRACKER ============
function getLadderHistory() { try { return JSON.parse(localStorage.getItem('ladder-history') || '{}'); } catch { return {}; } }
function saveLadderHistory(h) { localStorage.setItem('ladder-history', JSON.stringify(h)); }

function logLadder(level) {
  const today = new Date().toISOString().slice(0, 10);
  const history = getLadderHistory();
  history[today] = level;
  saveLadderHistory(history);
  renderLadderHistory();
}

function renderLadderHistory() {
  const history = getLadderHistory();
  const container = document.getElementById('ladderHistory');
  const today = new Date().toISOString().slice(0, 10);
  const todayLevel = history[today];

  // Highlight today's button
  document.querySelectorAll('.ladder-checkin-btn').forEach(btn => btn.classList.remove('today-active'));
  if (todayLevel) {
    const activeBtn = document.querySelector(`.lcb-${todayLevel}`);
    if (activeBtn) activeBtn.classList.add('today-active');
  }

  // Render last 14 days
  const days = [];
  for (let i = 13; i >= 0; i--) {
    const d = new Date(); d.setDate(d.getDate() - i);
    const key = d.toISOString().slice(0, 10);
    const dayNames = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
    days.push({ date: key, level: history[key], label: dayNames[d.getDay()] + ' ' + d.getDate() });
  }

  if (!Object.keys(history).length) {
    container.innerHTML = '';
    return;
  }

  container.innerHTML = `
    <div class="ladder-history-title">Last 14 days</div>
    <div class="ladder-history-row">
      ${days.map(d => d.level
        ? `<div class="ladder-history-dot lhd-${d.level}" title="${d.label}">${d.level}</div>`
        : `<div class="ladder-history-dot lhd-empty" title="${d.label}">¬∑</div>`
      ).join('')}
    </div>
  `;
}

renderLadderHistory();
</script>
</body>
</html>
